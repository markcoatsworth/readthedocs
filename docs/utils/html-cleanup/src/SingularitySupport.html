<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Singularity Support</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- 3,sec-filename,next,info,NoFonts,fonts,html --> 
<meta name="src" content="ref.tex"> 
<link rel="stylesheet" type="text/css" href="ref.css"> 
</head><body 
>
   <span style="font-size: 200%;"><a 
href="SettingUptheVMandDockerUniverses.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="SettingUptheVMandDockerUniverses.html#tailSettingUptheVMandDockerUniverses.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="#tailSingularitySupport.html">&#x2193;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="AdministratorsManual.html#SingularitySupport.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="PowerManagement.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><h3 class="sectionHead"><span class="titlemark">3.17   </span> <a 
 id="x45-3900003.17"></a>Singularity Support</h3>
   <div class="sectionTOCS">
   </div>
<a 
 id="dx45-390001"></a>
<a 
 id="dx45-390002"></a>
<!--l. 8--><p class="indent" >   Note: This documentation is very basic and needs improvement!
<!--l. 10--><p class="indent" >   Here&#8217;s an example configuration file:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-783">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;#</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Only</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;set</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;if</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;singularity</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;is</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;not</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;in</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$PATH.</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;#SINGULARITY</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/opt/singularity/bin/singularity</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;#</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Forces</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;_all_</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;jobs</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;to</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;run</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;inside</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;singularity.</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SINGULARITY_JOB</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;true</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;#</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Forces</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;all</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;jobs</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;to</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;use</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;the</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;CernVM-based</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;image.</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SINGULARITY_IMAGE_EXPR</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"/cvmfs/cernvm-prod.cern.ch/cvm3"</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;#</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Maps</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$_CONDOR_SCRATCH_DIR</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;on</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;the</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;host</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;to</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/srv</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;inside</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;the</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;image.</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SINGULARITY_TARGET_DIR</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/srv</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;#</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Writable</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;scratch</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;directories</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;inside</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;the</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;image.</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Auto-deleted</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;after</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;the</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;job</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;exits.</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;MOUNT_UNDER_SCRATCH</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/tmp,</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/var/tmp</tspan>
</div>
<!--l. 27--><p class="nopar" >
<!--l. 29--><p class="indent" >   This provides the user with no opportunity to select a specific image. Here are some changes to the above
example to allow the user to specify an image path:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-784">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SINGULARITY_JOB</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;!isUndefined(TARGET.SingularityImage)</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SINGULARITY_IMAGE_EXPR</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;TARGET.SingularityImage</tspan>
</div>
<!--l. 36--><p class="nopar" >
<!--l. 38--><p class="indent" >   Then, users could add the following to their submit file (note the quoting):
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-785">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;+SingularityImage</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"/cvmfs/cernvm-prod.cern.ch/cvm3"</tspan>
</div>
<!--l. 43--><p class="nopar" >
<!--l. 45--><p class="indent" >   Finally, let&#8217;s pick an image based on the OS &#8211; not the filename:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-786">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SINGULARITY_JOB</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(TARGET.DESIRED_OS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;isnt</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;MY.OpSysAndVer)</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;&amp;&amp;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;((TARGET.DESIRED_OS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;is</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"CentOS6")</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;||</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(TARGET.DESIRED_OS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;is</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"CentOS7"))</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SINGULARITY_IMAGE_EXPR</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(TARGET.DESIRED_OS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;is</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"CentOS6")</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;?</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"/cvmfs/cernvm-prod.cern.ch/cvm3"</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;:</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"/cvmfs/cms.cern.ch/rootfs/x86_64/centos7/latest"</tspan>
</div>
<!--l. 50--><p class="nopar" >
<!--l. 52--><p class="indent" >   Then, the user adds to their submit file:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-787">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;+DESIRED_OS="CentOS6"</tspan>
</div>
<!--l. 56--><p class="nopar" >
<!--l. 58--><p class="indent" >   That would cause the job to run on the native host for CentOS6 hosts and inside a CentOS6 Singularity
container on CentOS7 hosts.
                                                                                         

                                                                                         
<!--l. 2--><p class="indent" >   <span style="font-size: 200%;"><a 
href="SettingUptheVMandDockerUniverses.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="SettingUptheVMandDockerUniverses.html#tailSettingUptheVMandDockerUniverses.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="SingularitySupport.html" >&#x2191;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="AdministratorsManual.html#SingularitySupport.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="PowerManagement.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><a 
 id="tailSingularitySupport.html"></a> 
</body></html> 
