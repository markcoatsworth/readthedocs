<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Setting Up for Special Environments</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- 3,sec-filename,next,info,NoFonts,fonts,html --> 
<meta name="src" content="ref.tex"> 
<link rel="stylesheet" type="text/css" href="ref.css"> 
</head><body 
>
   <span style="font-size: 200%;"><a 
href="TheHighAvailabilityofDaemons.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="TheHighAvailabilityofDaemons.html#tailTheHighAvailabilityofDaemons.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="#tailSettingUpforSpecialEnvironments.html">&#x2193;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="AdministratorsManual.html#SettingUpforSpecialEnvironments.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="JavaSupportInstallation.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><h3 class="sectionHead"><span class="titlemark">3.14   </span> <a 
 id="x42-3440003.14"></a>Setting Up for Special Environments</h3>
   <div class="sectionTOCS">
   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.1 <a 
href="#x42-3450003.14.1">Using HTCondor with AFS</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3460003.14.1" id="QQ2-42-363">AFS and HTCondor for Administrators</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3470003.14.1" id="QQ2-42-364">AFS and HTCondor for Users</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.2 <a 
href="#x42-3480003.14.2"> Enabling the Transfer of Files Specified by a URL</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.3 <a 
href="#x42-3490003.14.3"> Enabling the Transfer of Public Input Files over HTTP</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3500003.14.3" id="QQ2-42-367">Install a web service for public input files</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3510003.14.3" id="QQ2-42-368">Configuration knobs for public input files</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3520003.14.3" id="QQ2-42-369">Additional HTTP infrastructure for public input files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.4 <a 
href="#x42-3530003.14.4">Configuring HTCondor for Multiple Platforms</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3540003.14.4" id="QQ2-42-371">Platform-Specific Configuration File Settings</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3550003.14.4" id="QQ2-42-372">Other Uses for Platform-Specific Configuration Files</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.5 <a 
href="#x42-3560003.14.5">Full Installation of condor_compile</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.6 <a 
href="#x42-3570003.14.6">The <span class="textit">condor_kbdd</span></a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3580003.14.6" id="QQ2-42-375">The <span class="textit">condor_kbdd</span> on Windows Platforms</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3590003.14.6" id="QQ2-42-376">The <span class="textit">condor_kbdd</span> on Linux Platforms</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.7 <a 
href="#x42-3600003.14.7"> Configuring The HTCondorView Server</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3610003.14.7" id="QQ2-42-378"> Configuring a Machine to be a HTCondorView Server</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3620003.14.7" id="QQ2-42-379"> Configuring a Pool to Report to the HTCondorView Server</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.8 <a 
href="#x42-3630003.14.8"> Running HTCondor Jobs within a Virtual Machine</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3640003.14.8" id="QQ2-42-381"> Installation and Configuration</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.9 <a 
href="#x42-3650003.14.9"> HTCondor&#8217;s Dedicated Scheduling</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3660003.14.9" id="QQ2-42-383"> Selecting and Setting Up a Dedicated Scheduler</a></span>
                                                                                         

                                                                                         
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3670003.14.9" id="QQ2-42-384"> Configuration Examples for Dedicated Resources</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3680003.14.9" id="QQ2-42-385"> Preemption with Dedicated Jobs</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3690003.14.9" id="QQ2-42-386"> Grouping Dedicated Nodes into Parallel Scheduling Groups</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.10 <a 
href="#x42-3700003.14.10">Configuring HTCondor for Running Backfill Jobs</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3710003.14.10" id="QQ2-42-388">Overview of Backfill jobs in HTCondor</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3720003.14.10" id="QQ2-42-389">Defining the Backfill Policy</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3730003.14.10" id="QQ2-42-390">Overview of the BOINC system</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3740003.14.10" id="QQ2-42-391">Installing the BOINC client software</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3750003.14.10" id="QQ2-42-392">Configuring the BOINC client under HTCondor</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x42-3760003.14.10" id="QQ2-42-393">BOINC on Windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.11 <a 
href="#x42-3770003.14.11">Per Job PID Namespaces</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.12 <a 
href="#x42-3780003.14.12">Group ID-Based Process Tracking</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.13 <a 
href="#x42-3790003.14.13">Cgroup-Based Process Tracking</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.14 <a 
href="#x42-3800003.14.14">Limiting Resource Usage with a User Job Wrapper</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.15 <a 
href="#x42-3810003.14.15">Limiting Resource Usage Using Cgroups</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.14.16 <a 
href="#x42-3820003.14.16">Concurrency Limits</a></span>
   </div>
<!--l. 5--><p class="indent" >   The following sections describe how to set up HTCondor for use in special environments or configurations.
<!--l. 2--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.1   </span> <a 
 id="x42-3450003.14.1"></a>Using HTCondor with AFS</h4>
<a 
 id="dx42-345001"></a>
<!--l. 6--><p class="noindent" >Configuration variables that allow machines to interact with and use a shared file system are given at
section&#x00A0;<a 
href="ConfigurationMacros.html#x33-1920003.5.5">3.5.5<!--tex4ht:ref: sec:Shared-Filesystem-Config-File-Entries --></a>.
<!--l. 10--><p class="indent" >   Limitations with AFS occur because HTCondor does not currently have a way to authenticate itself to AFS.
This is true of the HTCondor daemons that would like to authenticate as the AFS user condor, and of the
<span class="textit">condor_shadow</span> which would like to authenticate as the user who submitted the job it is serving. Since neither of
these things can happen yet, there are special things to do when interacting with AFS. Some of this must be done
                                                                                         

                                                                                         
by the administrator(s) installing HTCondor. Other things must be done by HTCondor users who submit
jobs.
<!--l. 21--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3460003.14.1"></a>AFS and HTCondor for Administrators</h5>
<!--l. 24--><p class="noindent" >The largest result from the lack of authentication with AFS is that the directory defined by the configuration
variable <span class="texttt">LOCAL_DIR</span> and its subdirectories <span class="texttt">log</span> and <span class="texttt">spool</span> on each machine must be either writable to
unauthenticated users, or must not be on AFS. Making these directories writable a <span class="emph">very</span> bad security hole, so it is
<span class="emph">not</span> a viable solution. Placing <span class="texttt">LOCAL_DIR</span> onto NFS is acceptable. To avoid AFS, place the directory defined for
<span class="texttt">LOCAL_DIR</span> on a local partition on each machine in the pool. This implies running <span class="textit">condor_configure</span> to install the
release directory and configure the pool, setting the <span class="texttt">LOCAL_DIR</span> variable to a local partition. When that
is complete, log into each machine in the pool, and run <span class="textit">condor_init</span> to set up the local HTCondor
directory.
<!--l. 39--><p class="indent" >   The directory defined by <span class="texttt">RELEASE_DIR</span>, which holds all the HTCondor binaries, libraries, and scripts, can be on
AFS. None of the HTCondor daemons need to write to these files. They only need to read them. So, the directory
defined by <span class="texttt">RELEASE_DIR</span> only needs to be world readable in order to let HTCondor function. This makes it easier to
upgrade the binaries to a newer version at a later date, and means that users can find the HTCondor tools in a
consistent location on all the machines in the pool. Also, the HTCondor configuration files may be placed in a
centralized location. This is what we do for the UW-Madison&#8217;s CS department HTCondor pool, and it works quite
well.
<!--l. 54--><p class="indent" >   Finally, consider setting up some targeted AFS groups to help users deal with HTCondor and AFS better. This
is discussed in the following manual subsection. In short, create an AFS group that contains all users, authenticated
or not, but which is restricted to a given host or subnet. These should be made as host-based ACLs with AFS, but
here at UW-Madison, we have had some trouble getting that working. Instead, we have a special group for all
machines in our department. The users here are required to make their output directories on AFS writable to any
process running on any of our machines, instead of any process on any machine with AFS on the
Internet.
<!--l. 69--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3470003.14.1"></a>AFS and HTCondor for Users</h5>
<!--l. 72--><p class="noindent" >The <span class="textit">condor_shadow</span> daemon runs on the machine where jobs are submitted. It performs all file system access on
behalf of the jobs. Because the <span class="textit">condor_shadow</span> daemon is not authenticated to AFS as the user who submitted the
job, the <span class="textit">condor_shadow</span> daemon will not normally be able to write any output. Therefore the directories in which
the job will be creating output files will need to be world writable; they need to be writable by non-authenticated
AFS users. In addition, the program&#8217;s <span class="texttt">stdout</span>, <span class="texttt">stderr</span>, log file, and any file the program explicitly opens will need
to be in a directory that is world-writable.
                                                                                         

                                                                                         
<!--l. 84--><p class="indent" >   An administrator may be able to set up special AFS groups that can make unauthenticated access to the
program&#8217;s files less scary. For example, there is supposed to be a way for AFS to grant access to any
unauthenticated process on a given host. If set up, write access need only be granted to unauthenticated processes
on the submit machine, as opposed to any unauthenticated process on the Internet. Similarly, unauthenticated read
access could be granted only to processes running on the submit machine.
<!--l. 97--><p class="indent" >   A solution to this problem is to not use AFS for output files. If disk space on the submit machine is available in a
partition not on AFS, submit the jobs from there. While the <span class="textit">condor_shadow</span> daemon is not authenticated to AFS,
it does run with the effective UID of the user who submitted the jobs. So, on a local (or NFS) file system, the
<span class="textit">condor_shadow</span> daemon will be able to access the files, and no special permissions need be granted to anyone other
than the job submitter. If the HTCondor daemons are not invoked as root however, the <span class="textit">condor_shadow</span> daemon will
not be able to run with the submitter&#8217;s effective UID, leading to a similar problem as with files on
AFS.
<!--l. 3--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.2   </span> <a 
 id="x42-3480003.14.2"></a> Enabling the Transfer of Files Specified by a URL</h4>
<a 
 id="dx42-348001"></a>
<a 
 id="dx42-348002"></a>
<a 
 id="dx42-348003"></a>
<!--l. 9--><p class="noindent" >Because staging data on the submit machine is not always efficient, HTCondor permits input files to be transferred
from a location specified by a URL; likewise, output files may be transferred to a location specified by a URL. All
transfers (both input and output) are accomplished by invoking a <span class="emph">plug-in</span>, an executable or shell script that handles
the task of file transfer.
<!--l. 18--><p class="indent" >   For transferring input files, URL specification is limited to jobs running under the vanilla universe and to a vm
universe VM image file. The execute machine retrieves the files. This differs from the normal file transfer
mechanism, in which transfers are from the machine where the job is submitted to the machine where the job is
executed. Each file to be transferred by specifying a URL, causing a plug-in to be invoked, is specified separately
in the job submit description file with the command <span class="textbf">transfer_input_files</span><a 
 id="dx42-348004"></a>; see section&#x00A0;<a 
href="SubmittingaJob.html#x17-440002.5.9">2.5.9<!--tex4ht:ref: sec:file-transfer-by-URL --></a> for
details.
<!--l. 30--><p class="indent" >   For transferring output files, either the entire output sandbox, which are all files produced or modified by
the job as it executes, or a subset of these files, as specified by the submit description file command
<span class="textbf">transfer_output_files</span><a 
 id="dx42-348005"></a> are transferred to the directory specified by the URL. The URL itself is specified in the
separate submit description file command <span class="textbf">output_destination</span><a 
 id="dx42-348006"></a>; see section&#x00A0;<a 
href="SubmittingaJob.html#x17-440002.5.9">2.5.9<!--tex4ht:ref: sec:file-transfer-by-URL --></a> for details. The plug-in is
invoked once for each output file to be transferred.
<!--l. 41--><p class="indent" >   Configuration identifies the availability of the one or more plug-in(s). The plug-ins must be installed and
available on every execute machine that may run a job which might specify a URL, either for input or for
output.
<!--l. 45--><p class="indent" >   URL transfers are enabled by default in the configuration of execute machines. Disabling URL transfers is
accomplished by setting
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-699">
<tspan font-family="ectt" font-size="0800">ENABLE_URL_TRANSFERS</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;FALSE</tspan>
</div>
<!--l. 51--><p class="nopar" >
<!--l. 54--><p class="indent" >   A comma separated list giving the absolute path and name of all available plug-ins is specified as in the
example:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-700">
<tspan font-family="ectt" font-size="0800">FILETRANSFER_PLUGINS</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/opt/condor/plugins/wget-plugin,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/opt/condor/plugins/hdfs-plugin,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/opt/condor/plugins/custom-plugin</tspan>
</div>
<!--l. 61--><p class="nopar" >
<!--l. 64--><p class="indent" >   The <span class="textit">condor_starter</span> invokes all listed plug-ins to determine their capabilities. Each may handle one or more
protocols (scheme names). The plug-in&#8217;s response to invocation identifies which protocols it can handle. When a
URL transfer is specified by a job, the <span class="textit">condor_starter</span> invokes the proper one to do the transfer. If more than one
plugin is capable of handling a particular protocol, then the last one within the list given by <span class="texttt">FILETRANSFER_PLUGINS</span>
is used.
<!--l. 74--><p class="indent" >   HTCondor assumes that all plug-ins will respond in specific ways. To determine the capabilities
of the plug-ins as to which protocols they handle, the <span class="textit">condor_starter</span> daemon invokes each plug-in
giving it the command line argument <span class="textbf">-classad</span>. In response to invocation with this command line
argument, the plug-in must respond with an output of three ClassAd attributes. The first two are
fixed:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-701">
<tspan font-family="ectt" font-size="0800">PluginVersion</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"0.1"</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">PluginType</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"FileTransfer"</tspan>
</div>
<!--l. 87--><p class="nopar" >
<!--l. 90--><p class="indent" >   The third ClassAd attribute is <span class="texttt">SupportedMethods</span>. This attribute is a string containing a comma separated list
of the protocols that the plug-in handles. So, for example
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-702">
<tspan font-family="ectt" font-size="0800">SupportedMethods</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"http,ftp,file"</tspan>
</div>
<!--l. 97--><p class="nopar" > would identify that the three protocols described by <span class="obeylines-h"><span class="verb">http</span></span>, <span class="obeylines-h"><span class="verb">ftp</span></span>, and <span class="obeylines-h"><span class="verb">file</span></span> are supported. These strings will match
the protocol specification as given within a URL in a <span class="textbf">transfer_input_files</span><a 
 id="dx42-348007"></a> command or within a URL in an
<span class="textbf">output_destination</span><a 
 id="dx42-348008"></a> command in a submit description file for a job.
<!--l. 106--><p class="indent" >   When a job specifies a URL transfer, the plug-in is invoked, without the command line argument <span class="textbf">-classad</span>. It
will instead be given two other command line arguments. For the transfer of input file(s), the first will be
the URL of the file to retrieve and the second will be the absolute path identifying where to place
the transferred file. For the transfer of output file(s), the first will be the absolute path on the local
machine of the file to transfer, and the second will be the URL of the directory and file name at the
destination.
<!--l. 119--><p class="indent" >   The plug-in is expected to do the transfer, exiting with status 0 if the transfer was successful, and a non-zero
status if the transfer was <span class="emph">not</span> successful. When <span class="emph">not</span> successful, the job is placed on hold, and the job ClassAd
attribute <span class="texttt">HoldReason</span> will be set as appropriate for the job. The job ClassAd attribute <span class="texttt">HoldReasonSubCode</span> will be
set to the exit status of the plug-in.
<!--l. 128--><p class="indent" >   As an example of the transfer of a subset of output files, assume that the submit description file
contains
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-703">
<tspan font-family="ectt" font-size="0800">output_destination</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;url://server/some/directory/</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">transfer_output_files</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;foo,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;bar,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;qux</tspan>
</div>
<!--l. 134--><p class="nopar" > HTCondor invokes the plug-in that handles the <span class="texttt">url</span> protocol three times. The directory delimiter (<span class="obeylines-h"><span class="verb">/</span></span> on Unix, and <span class="obeylines-h"><span class="verb">\</span></span>
on Windows) is appended to the destination URL, such that the three (Unix) invocations of the plug-in will appear
similar to
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-704">
<tspan font-family="ectt" font-size="0800">url_plugin</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/path/to/local/copy/of/foo</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;url://server/some/directory//foo</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">url_plugin</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/path/to/local/copy/of/bar</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;url://server/some/directory//bar</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">url_plugin</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/path/to/local/copy/of/qux</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;url://server/some/directory//qux</tspan>
</div>
<!--l. 147--><p class="nopar" >
<!--l. 150--><p class="indent" >   Note that this functionality is not limited to a predefined set of protocols. New ones can be invented. As an
invented example, the <span class="obeylines-h"><span class="verb">zkm</span></span> transfer type writes random bytes to a file. The plug-in that handles <span class="obeylines-h"><span class="verb">zkm</span></span> transfers would
respond to invocation with the <span class="textbf">-classad</span> command line argument with:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-705">
<tspan font-family="ectt" font-size="0800">PluginVersion</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"0.1"</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">PluginType</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"FileTransfer"</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">SupportedMethods</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"zkm"</tspan>
</div>
<!--l. 162--><p class="nopar" > And, then when a job requested that this plug-in be invoked, for the invented example:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-706">
<tspan font-family="ectt" font-size="0800">transfer_input_files</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;zkm://128/r-data</tspan>
</div>
<!--l. 169--><p class="nopar" > the plug-in will be invoked with a first command line argument of <span class="obeylines-h"><span class="verb">zkm://128/r-data</span></span> and a second command line
argument giving the full path along with the file name <span class="texttt">r-data</span> as the location for the plug-in to write 128 bytes of
random data.
<!--l. 176--><p class="indent" >   The transfer of output files in this manner was introduced in HTCondor version 7.6.0. Incompatibility and
inability to function will result if the executables for the <span class="textit">condor_starter</span> and <span class="textit">condor_shadow</span> are versions earlier
than HTCondor version 7.6.0. Here is the expected behavior for these cases that cannot be backward
compatible.
     <ul class="itemize1">
     <li class="itemize">If  the  <span class="textit">condor_starter</span>  version  is  earlier  than  7.6.0,  then  regardless  of  the  <span class="textit">condor_shadow</span>
     version,  transfer  of  output  files,  as  identified  in  the  submit  description  file  with  the  command
     <span class="textbf">output_destination</span><a 
 id="dx42-348009"></a> is ignored. The files are transferred back to the submit machine.
     </li>
     <li class="itemize">If the <span class="textit">condor_starter</span> version is 7.6.0 or later, but the <span class="textit">condor_shadow</span> version is earlier than 7.6.0, then
     the <span class="textit">condor_starter</span> will attempt to send the command to the <span class="textit">condor_shadow</span>, but the <span class="textit">condor_shadow</span>
     will ignore the command. No files will be transferred, and the job will be placed on hold.</li></ul>
<!--l. 200--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.3   </span> <a 
 id="x42-3490003.14.3"></a> Enabling the Transfer of Public Input Files over HTTP</h4>
<!--l. 203--><p class="noindent" >Another option for transferring files over HTTP is for users to specify a list of <span class="emph">public input files</span>. These are specified
in the submit file as follows:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-707">
<tspan font-family="ectt" font-size="0800">public_input_files</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;file1,file2,file3</tspan>
</div>
<!--l. 209--><p class="nopar" >
<!--l. 212--><p class="indent" >   HTCondor will automatically convert these files into URLs and transfer them over HTTP using plug-ins. The
advantage to this approach is that system administrators can leverage Squid caches or load-balancing infrastructure,
resulting in improved performance. This also allows us to gather statistics about file transfers that were not
previously available.
<!--l. 218--><p class="indent" >   When a user submits a job with public input files, HTCondor generates a hash link for each file in the root
directory for the web server. Each of these links points back to the original file on local disk. Next, HTCondor
replaces the names of the files in the submit job with web links to their hashes. These get sent to the execute node,
which downloads the files using our curl_plugin tool, and are then remapped back to their original
names.
<!--l. 226--><p class="indent" >   In the event of any errors or configuration problems, HTCondor will fall back to a regular (non-HTTP) file
transfer.
<!--l. 229--><p class="indent" >   To enable HTTP public file transfers, a system administrator must perform several steps as described
below.
<!--l. 234--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3500003.14.3"></a>Install a web service for public input files</h5>
<!--l. 237--><p class="noindent" >An HTTP service must be installed and configured on the submit node. Any regular web server software such as
Apache (<a 
href="https://httpd.apache.org/" >https://httpd.apache.org/</a>) or nginx (<a 
href="https://nginx.org" >https://nginx.org</a>) will do. The submit node must be running a Linux
system.
<!--l. 244--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3510003.14.3"></a>Configuration knobs for public input files</h5>
<!--l. 247--><p class="noindent" >Several knobs must be set and configured correctly for this functionality to work:
     <ul class="itemize1">
     <li class="itemize"><span class="texttt">ENABLE_HTTP_PUBLIC_FILES</span> <a 
 id="dx42-351001"></a><a 
 id="dx42-351002"></a>: Must be set to true (default: <span class="emph">false</span>)
                                                                                         

                                                                                         
     </li>
     <li class="itemize"><span class="texttt">HTTP_PUBLIC_FILES_ADDRESS</span> <a 
 id="dx42-351003"></a><a 
 id="dx42-351004"></a>: The full web address (hostname + port) where your web server is
     serving files (default: <span class="emph">127.0.0.1:8080</span>)
     </li>
     <li class="itemize"><span class="texttt">HTTP_PUBLIC_FILES_ROOT_DIR</span> <a 
 id="dx42-351005"></a><a 
 id="dx42-351006"></a>: Absolute path to the local directory where the web service is serving
     files from.
     </li>
     <li class="itemize"><span class="texttt">HTTP_PUBLIC_FILES_USER</span> <a 
 id="dx42-351007"></a><a 
 id="dx42-351008"></a>: User security level used to write links to the directory specified by
     HTTP_PUBLIC_FILES_ROOT_DIR. There are three valid options for this knob:
         <ol  class="enumerate1" >
         <li 
  class="enumerate" id="x42-351010x1"><span class="textbf">&#x003C;user&#x003E;</span>: Links will be written as user who submitted the job.
         </li>
         <li 
  class="enumerate" id="x42-351012x2"><span class="textbf">&#x003C;condor&#x003E;</span>: Links will be written as user running condor daemons. By default this is the user
         <span class="emph">condor</span> unless you have changed this by setting the configuration parameter CONDOR_IDS.
         </li>
         <li 
  class="enumerate" id="x42-351014x3"><span class="textbf">&#x003C;<span class="emph">%username%</span>&#x003E;</span>: Links will be written as the user <span class="emph">%username%</span> (ie. <span class="emph">httpd</span>, <span class="emph">nobody</span>) If using
         this option, make sure the directory is writable by this particular user.</li></ol>
     <!--l. 269--><p class="noindent" >The default setting is <span class="emph">&#x003C;condor&#x003E;</span>.</li></ul>
<!--l. 274--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3520003.14.3"></a>Additional HTTP infrastructure for public input files</h5>
<!--l. 277--><p class="noindent" >The main advantage of using HTTP for file transfers is that system administrators can use additional infrastructure
(such as Squid caching) to improve file transfer performance. This is outside the scope of the HTCondor
configuration but is still worth mentioning here. When curl_plugin is invoked, it checks the environment variable
<span class="emph">http_proxy</span> for a proxy server address; by setting this appropriately on execute nodes, a system can dramatically
improve transfer speeds for commonly used files.
<!--l. 3--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.4   </span> <a 
 id="x42-3530003.14.4"></a>Configuring HTCondor for Multiple Platforms</h4>
<!--l. 6--><p class="noindent" >A single, initial configuration file may be used for all platforms in an HTCondor pool, with platform-specific
settings placed in separate files. This greatly simplifies administration of a heterogeneous pool by
allowing specification of platform-independent, global settings in one place, instead of separately for
each platform. This is made possible by treating the <span class="texttt">LOCAL_CONFIG_FILE</span> <a 
 id="dx42-353001"></a><a 
 id="dx42-353002"></a> configuration variable as
a list of files, instead of a single file. Of course, this only helps when using a shared file system for
the machines in the pool, so that multiple machines can actually share a single set of configuration
files.
                                                                                         

                                                                                         
<!--l. 19--><p class="indent" >   With multiple platforms, put all platform-independent settings (the vast majority) into the single initial
configuration file, which will be shared by all platforms. Then, set the <span class="texttt">LOCAL_CONFIG_FILE</span> configuration variable
from that global configuration file to specify both a platform-specific configuration file and optionally, a local,
machine-specific configuration file.
<!--l. 28--><p class="indent" >   The name of platform-specific configuration files may be specified by using <span class="texttt">$(ARCH)</span> and <span class="texttt">$(OPSYS)</span>, as defined
automatically by HTCondor. For example, for 32-bit Intel Windows 7 machines and 64-bit Intel Linux machines, the
files ought to be named:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-708">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_config.INTEL.WINDOWS</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_config.X86_64.LINUX</tspan>
</div>
<!--l. 39--><p class="nopar" >
<!--l. 41--><p class="indent" >   Then, assuming these files are in the directory defined by the <span class="texttt">ETC</span> configuration variable, and machine-specific
configuration files are in the same directory, named by each machine&#8217;s host name, <span class="texttt">LOCAL_CONFIG_FILE</span> <a 
 id="dx42-353003"></a><a 
 id="dx42-353004"></a>
becomes:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-709">
<tspan font-family="ectt" font-size="0800">LOCAL_CONFIG_FILE</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(ETC)/condor_config.$(ARCH).$(OPSYS),</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(ETC)/$(HOSTNAME).local</tspan>
</div>
<!--l. 51--><p class="nopar" >
<!--l. 54--><p class="indent" >   Alternatively, when using AFS, an <span class="texttt">@sys</span> link may be used to specify the platform-specific configuration file,
which lets AFS resolve this link based on platform name. For example, consider a soft link named
<span class="texttt">condor_config.platform</span> that points to <span class="texttt">condor_config.@sys</span>. In this case, the files might be named:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-710">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_config.i386_linux2</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_config.platform</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-&#x003E;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_config.@sys</tspan>
</div>
<!--l. 64--><p class="nopar" >
<!--l. 66--><p class="indent" >   and the <span class="texttt">LOCAL_CONFIG_FILE</span> configuration variable would be set to
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-711">
<tspan font-family="ectt" font-size="0800">LOCAL_CONFIG_FILE</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(ETC)/condor_config.platform,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(ETC)/$(HOSTNAME).local</tspan>
</div>
<!--l. 72--><p class="nopar" >
<!--l. 77--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3540003.14.4"></a>Platform-Specific Configuration File Settings</h5>
<!--l. 80--><p class="noindent" >The configuration variables that are truly platform-specific are:
     <dl class="description"><dt class="description">
<span class="texttt">RELEASE_DIR</span> <a 
 id="dx42-354001"></a><a 
 id="dx42-354002"></a> </dt><dd 
class="description">Full  path  to  to  the  installed  HTCondor  binaries.  While  the  configuration  files  may  be
     shared among different platforms, the binaries certainly cannot. Therefore, maintain separate release
     directories for each platform in the pool.
     </dd><dt class="description">
<span class="texttt">MAIL</span> <a 
 id="dx42-354003"></a><a 
 id="dx42-354004"></a> </dt><dd 
class="description">The full path to the mail program.
     </dd><dt class="description">
<span class="texttt">CONSOLE_DEVICES</span> <a 
 id="dx42-354005"></a><a 
 id="dx42-354006"></a> </dt><dd 
class="description">Which devices in <span class="texttt">/dev</span> should be treated as console devices.
     </dd><dt class="description">
<span class="texttt">DAEMON_LIST</span> <a 
 id="dx42-354007"></a><a 
 id="dx42-354008"></a> </dt><dd 
class="description">Which   daemons   the   <span class="textit">condor_master</span>  should   start   up.   The   reason   this   setting   is
     platform-specific is to distinguish the <span class="textit">condor_kbdd</span>. It is needed on many Linux and Windows machines,
     and it is not needed on other platforms.
     </dd></dl>
<!--l. 103--><p class="indent" >   Reasonable defaults for all of these configuration variables will be found in the default configuration files inside a
given platform&#8217;s binary distribution (except the <span class="texttt">RELEASE_DIR</span>, since the location of the HTCondor binaries and
libraries is installation specific). With multiple platforms, use one of the <span class="texttt">condor_config</span> files from either running
<span class="textit">condor_configure</span> or from the <span class="texttt"><span class="texttt">$(RELEASE_DIR)</span>/etc/examples/condor_config.generic</span> file, take these settings
out, save them into a platform-specific file, and install the resulting platform-independent file as the global
configuration file. Then, find the same settings from the configuration files for any other platforms to be set up, and
put them in their own platform-specific files. Finally, set the <span class="texttt">LOCAL_CONFIG_FILE</span> configuration variable to point to
the appropriate platform-specific file, as described above.
<!--l. 123--><p class="indent" >   Not even all of these configuration variables are necessarily going to be different. For example, if an installed mail
program understands the <span class="textbf">-s</span> option in <span class="texttt">/usr/local/bin/mail</span> on all platforms, the <span class="texttt">MAIL</span> macro may be set to that in
                                                                                         

                                                                                         
the global configuration file, and not define it anywhere else. For a pool with only Linux or Windows machines, the
<span class="texttt">DAEMON_LIST</span> will be the same for each, so there is no reason not to put that in the global configuration
file.
<!--l. 135--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3550003.14.4"></a>Other Uses for Platform-Specific Configuration Files</h5>
<!--l. 138--><p class="noindent" >It is certainly possible that an installation may want other configuration variables to be platform-specific as well.
Perhaps a different policy is desired for one of the platforms. Perhaps different people should get the e-mail about
problems with the different platforms. There is nothing hard-coded about any of this. What is shared and what
should not shared is entirely configurable.
<!--l. 148--><p class="indent" >   Since the <span class="texttt">LOCAL_CONFIG_FILE</span> <a 
 id="dx42-355001"></a><a 
 id="dx42-355002"></a> macro can be an arbitrary list of files, an installation can even break up the
global, platform-independent settings into separate files. In fact, the global configuration file might only contain a
definition for <span class="texttt">LOCAL_CONFIG_FILE</span>, and all other configuration variables would be placed in separate
files.
<!--l. 155--><p class="indent" >   Different people may be given different permissions to change different HTCondor settings. For example, if a user
is to be able to change certain settings, but nothing else, those settings may be placed in a file which was early in
the <span class="texttt">LOCAL_CONFIG_FILE</span> list, to give that user write permission on that file. Then, include all the other files after
that one. In this way, if the user was attempting to change settings that the user should not be permitted to change,
the settings would be overridden.
<!--l. 166--><p class="indent" >   This mechanism is quite flexible and powerful. For very specific configuration needs, they can probably be met
by using file permissions, the <span class="texttt">LOCAL_CONFIG_FILE</span> configuration variable, and imagination.
<!--l. 3--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.5   </span> <a 
 id="x42-3560003.14.5"></a>Full Installation of condor_compile</h4>
<!--l. 6--><p class="noindent" >In order to take advantage of two major HTCondor features: checkpointing and remote system calls, users need to
relink their binaries. Programs that are not relinked for HTCondor can run under HTCondor&#8217;s vanilla universe.
However, these jobs cannot take checkpoints and migrate.
<!--l. 13--><p class="indent" >   To relink programs with HTCondor, we provide the <span class="textit">condor_compile</span> tool. As installed by default,
<span class="textit">condor_compile</span> works with the following commands: <span class="textit">gcc</span>, <span class="textit">g++</span>, <span class="textit">g77</span>, <span class="textit">cc</span>, <span class="textit">acc</span>, <span class="textit">c89</span>, <span class="textit">CC</span>, <span class="textit">f77</span>, <span class="textit">fort77</span>, <span class="textit">ld</span>. See the
<span class="textit">condor_compile</span>(1) man page for details on using <span class="textit">condor_compile</span>.
<!--l. 23--><p class="indent" >   <span class="textit">condor_compile</span> can work transparently with all commands on the system, including <span class="textit">make</span>. The basic idea here
is to replace the system linker (<span class="textit">ld</span>) with the HTCondor linker. Then, when a program is to be linked, the HTCondor
linker figures out whether this binary will be for HTCondor, or for a normal binary. If it is to be a normal compile,
the old <span class="textit">ld</span> is called. If this binary is to be linked for HTCondor, the script performs the necessary operations in order
to prepare a binary that can be used with HTCondor. In order to differentiate between normal builds and
                                                                                         

                                                                                         
HTCondor builds, the user simply places <span class="textit">condor_compile</span> before their build command, which sets
the appropriate environment variable that lets the HTCondor linker script know it needs to do its
magic.
<!--l. 38--><p class="indent" >   In order to perform this full installation of <span class="textit">condor_compile</span>, the following steps need to be taken:
<!--l. 41--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x42-356002x1">Rename the system linker from <span class="textit">ld</span> to <span class="textit">ld.real</span>.
     </li>
     <li 
  class="enumerate" id="x42-356004x2">Copy the HTCondor linker to the location of the previous <span class="textit">ld</span>.
     </li>
     <li 
  class="enumerate" id="x42-356006x3">Set the owner of the linker to root.
     </li>
     <li 
  class="enumerate" id="x42-356008x4">Set the permissions on the new linker to 755.</li></ol>
<!--l. 49--><p class="indent" >   The actual commands to execute depend upon the platform. The location of the system linker (<span class="textit">ld</span>), is as
follows:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-712">
<tspan font-family="ectt" font-size="1000">Operating</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;System</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Location</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;of</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;ld</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(ld-path)</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">Linux</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/usr/bin</tspan>
</div>
<!--l. 54--><p class="nopar" >
<!--l. 58--><p class="indent" >   On these platforms, issue the following commands (as root), where <span class="textit">ld-path</span> is replaced by the path to the
system&#8217;s <span class="textit">ld</span>.
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-713">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;mv</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/[ld-path]/ld</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/&#x003C;ld-path&#x003E;/ld.real</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;cp</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/usr/local/condor/lib/ld</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/&#x003C;ld-path&#x003E;/ld</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;chown</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;root</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/&#x003C;ld-path&#x003E;/ld</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;chmod</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;755</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/&#x003C;ld-path&#x003E;/ld</tspan>
</div>
<!--l. 65--><p class="nopar" >
<!--l. 67--><p class="indent" >   If you remove HTCondor from your system later on, linking will continue to work, since the HTCondor linker
will always default to compiling normal binaries and simply call the real <span class="textit">ld</span>. In the interest of simplicity, it is
recommended that you reverse the above changes by moving your <span class="textit">ld.real</span> linker back to its former position as <span class="textit">ld</span>,
overwriting the HTCondor linker.
<!--l. 74--><p class="indent" >   <span class="underline">NOTE</span>: If you ever upgrade your operating system after performing a full installation of <span class="textit">condor_compile</span>, you
will probably have to re-do all the steps outlined above. Generally speaking, new versions or patches of
an operating system might replace the system <span class="textit">ld</span> binary, which would undo the full installation of
<span class="textit">condor_compile</span>.
<!--l. 2--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.6   </span> <a 
 id="x42-3570003.14.6"></a>The <span class="textit">condor_kbdd</span></h4>
<a 
 id="dx42-357001"></a>
<a 
 id="dx42-357002"></a>
<a 
 id="dx42-357003"></a>
<!--l. 8--><p class="noindent" >The HTCondor keyboard daemon, <span class="textit">condor_kbdd</span>, monitors X events on machines where the operating system does
not provide a way of monitoring the idle time of the keyboard or mouse. On Linux platforms, it is needed to detect
USB keyboard activity. Otherwise, it is not needed. On Windows platforms, the <span class="textit">condor_kbdd</span> is the primary way of
monitoring the idle time of both the keyboard and mouse.
<!--l. 19--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3580003.14.6"></a>The <span class="textit">condor_kbdd</span> on Windows Platforms</h5>
<!--l. 22--><p class="noindent" >Windows platforms need to use the <span class="textit">condor_kbdd</span> to monitor the idle time of both the keyboard and
mouse. By adding <span class="texttt">KBDD</span> to configuration variable <span class="texttt">DAEMON_LIST</span>, the <span class="textit">condor_master</span> daemon invokes
the <span class="textit">condor_kbdd</span>, which then does the right thing to monitor activity given the version of Windows
running.
<!--l. 29--><p class="indent" >   With Windows Vista and more recent version of Windows, user sessions are moved out of session 0. Therefore,
                                                                                         

                                                                                         
the <span class="textit">condor_startd</span> service is no longer able to listen to keyboard and mouse events. The <span class="textit">condor_kbdd</span> will run in an
invisible window and should not be noticeable by the user, except for a listing in the task manager. When the user
logs out, the program is terminated by Windows. This implementation also appears in versions of
Windows that predate Vista, because it adds the capability of monitoring keyboard activity from multiple
users.
<!--l. 41--><p class="indent" >   To achieve the auto-start with user login, the HTCondor installer adds a <span class="textit">condor_kbdd</span> entry to the registry key at
<span class="obeylines-h"><span class="verb">HKLM\Software\Microsoft\Windows\CurrentVersion\Run</span></span>. On 64-bit versions of Vista and more recent Windows
versions, the entry is actually placed in <span class="obeylines-h"><span class="verb">HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run</span></span>.
<!--l. 48--><p class="indent" >   In instances where the <span class="textit">condor_kbdd</span> is unable to connect to the <span class="textit">condor_startd</span>, it is likely because an exception
was not properly added to the Windows firewall.
<!--l. 54--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3590003.14.6"></a>The <span class="textit">condor_kbdd</span> on Linux Platforms</h5>
<!--l. 57--><p class="noindent" >On Linux platforms, great measures have been taken to make the <span class="textit">condor_kbdd</span> as robust as possible, but the X
window system was not designed to facilitate such a need, and thus is not as efficient on machines where many users
frequently log in and out on the console.
<!--l. 63--><p class="indent" >   In order to work with X authority, which is the system by which X authorizes processes to connect to X servers,
the <span class="textit">condor_kbdd</span> needs to run with super user privileges. Currently, the <span class="textit">condor_kbdd</span> assumes that X uses the <span class="texttt">HOME</span>
environment variable in order to locate a file named <span class="texttt">.Xauthority</span>. This file contains keys necessary to connect to an
X server. The keyboard daemon attempts to set <span class="texttt">HOME</span> to various users&#8217; home directories in order to gain a
connection to the X server and monitor events. This may fail to work if the keyboard daemon is not allowed to
attach to the X server, and the state of a machine may be incorrectly set to idle when a user is, in fact, using the
machine.
<!--l. 79--><p class="indent" >   In some environments, the <span class="textit">condor_kbdd</span> will not be able to connect to the X server because the user currently
logged into the system keeps their authentication token for using the X server in a place that no local user on the
current machine can get to. This may be the case for files on AFS, because the user&#8217;s <span class="texttt">.Xauthority</span> file is in an AFS
home directory.
<!--l. 86--><p class="indent" >   There may also be cases where the <span class="textit">condor_kbdd</span> may not be run with super user privileges because of political
reasons, but it is still desired to be able to monitor X activity. In these cases, change the XDM configuration in
order to start up the <span class="textit">condor_kbdd</span> with the permissions of the logged in user. If running X11R6.3, the files to edit
will probably be in <span class="texttt">/usr/X11R6/lib/X11/xdm</span>. The <span class="texttt">.xsession</span> file should start up the <span class="textit">condor_kbdd</span> at the end, and
the <span class="texttt">.Xreset</span> file should shut down the <span class="textit">condor_kbdd</span>. The <span class="textbf">-l</span> option can be used to write the daemon&#8217;s log file to
a place where the user running the daemon has permission to write a file. The file&#8217;s recommended
location will be similar to <span class="texttt">$HOME/.kbdd.log</span>, since this is a place where every user can write, and the file
will not get in the way. The <span class="textbf">-pidfile</span> and <span class="textbf">-k</span> options allow for easy shut down of the <span class="textit">condor_kbdd</span> by
storing the process ID in a file. It will be necessary to add lines to the XDM configuration similar
to
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-714">
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;condor_kbdd</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-l</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$HOME/.kbdd.log</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-pidfile</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$HOME/.kbdd.pid</tspan>
</div>
<!--l. 113--><p class="nopar" >
<!--l. 116--><p class="indent" >   This will start the <span class="textit">condor_kbdd</span> as the user who is currently logged in and write the log to a file in the directory
<span class="texttt">$HOME/.kbdd.log/</span>. This will also save the process ID of the daemon to <span class="texttt">&#x02DC;/.kbdd.pid</span>, so that when the user logs
out, XDM can do:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-715">
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;condor_kbdd</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-k</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$HOME/.kbdd.pid</tspan>
</div>
<!--l. 126--><p class="nopar" >
<!--l. 129--><p class="indent" >   This will shut down the process recorded in file <span class="texttt">&#x02DC;/.kbdd.pid</span> and exit.
<!--l. 132--><p class="indent" >   To see how well the keyboard daemon is working, review the log for the daemon and look for successful
connections to the X server. If there are none, the <span class="textit">condor_kbdd</span> is unable to connect to the machine&#8217;s X
server.
<!--l. 3--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.7   </span> <a 
 id="x42-3600003.14.7"></a> Configuring The HTCondorView Server</h4>
<a 
 id="dx42-360001"></a>
<!--l. 7--><p class="noindent" >The HTCondorView server is an alternate use of the <span class="textit">condor_collector</span> that logs information on disk, providing a
persistent, historical database of pool state. This includes machine state, as well as the state of jobs submitted by
users.
<!--l. 14--><p class="indent" >   An existing <span class="textit">condor_collector</span> may act as the HTCondorView collector through configuration. This is the
simplest situation, because the only change needed is to turn on the logging of historical information. The
alternative of configuring a new <span class="textit">condor_collector</span> to act as the HTCondorView collector is slightly more
complicated, while it offers the advantage that the same HTCondorView collector may be used for several pools as
desired, to aggregate information into one place.
<!--l. 24--><p class="indent" >   The following sections describe how to configure a machine to run a HTCondorView server and to configure a
pool to send updates to it.
<!--l. 30--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3610003.14.7"></a> Configuring a Machine to be a HTCondorView Server</h5>
<a 
 id="dx42-361001"></a>
<!--l. 35--><p class="noindent" >To configure the HTCondorView collector, a few configuration variables are added or modified for
the <span class="textit">condor_collector</span> chosen to act as the HTCondorView collector. These configuration variables
are described in section&#x00A0;<a 
href="ConfigurationMacros.html#x33-2010003.5.14">3.5.14<!--tex4ht:ref: sec:Collector-Config-File-Entries --></a> on page&#x00A0;<a 
href="ConfigurationMacros.html#x33-2010003.5.14">729<!--tex4ht:ref: sec:Collector-Config-File-Entries --></a>. Here are brief explanations of the entries that must be
customized:
                                                                                         

                                                                                         
     <dl class="description"><dt class="description">
<span class="texttt">POOL_HISTORY_DIR</span> <a 
 id="dx42-361002"></a><a 
 id="dx42-361003"></a> </dt><dd 
class="description">The directory where historical data will be stored. This directory must be writable
     by whatever user the HTCondorView collector is running as (usually the user condor). There is a
     configurable limit to the maximum space required for all the files created by the HTCondorView server
     called (<span class="texttt">POOL_HISTORY_MAX_STORAGE</span> <a 
 id="dx42-361004"></a><a 
 id="dx42-361005"></a>).
     <!--l. 54--><p class="noindent" ><span class="underline">NOTE</span>: This directory should be separate and different from the <span class="texttt">spool</span> or <span class="texttt">log</span> directories already set
     up for HTCondor. There are a few problems putting these files into either of those directories.
     </dd><dt class="description">
<span class="texttt">KEEP_POOL_HISTORY</span> <a 
 id="dx42-361006"></a><a 
 id="dx42-361007"></a> </dt><dd 
class="description">A boolean value that determines if the HTCondorView collector should store the
     historical information. It is <span class="texttt">False</span> by default, and must be specified as <span class="texttt">True</span> in the local configuration
     file to enable data collection.
     </dd></dl>
<!--l. 67--><p class="indent" >   Once these settings are in place in the configuration file for the HTCondorView server host, create the directory
specified in <span class="texttt">POOL_HISTORY_DIR</span> and make it writable by the user the HTCondorView collector is running
as. This is the same user that owns the <span class="texttt">CollectorLog</span> file in the <span class="texttt">log</span> directory. The user is usually
condor.
<!--l. 74--><p class="indent" >   If using the existing <span class="textit">condor_collector</span> as the HTCondorView collector, no further configuration is needed. To run
a different <span class="textit">condor_collector</span> to act as the HTCondorView collector, configure HTCondor to automatically start
it.
<!--l. 80--><p class="indent" >   If using a separate host for the HTCondorView collector, to start it, add the value <span class="texttt">COLLECTOR</span> to <span class="texttt">DAEMON_LIST</span>,
and restart HTCondor on that host. To run the HTCondorView collector on the same host as another
<span class="textit">condor_collector</span>, ensure that the two <span class="textit">condor_collector</span> daemons use different network ports. Here is an example
configuration in which the main <span class="textit">condor_collector</span> and the HTCondorView collector are started up by the same
<span class="textit">condor_master</span> daemon on the same machine. In this example, the HTCondorView collector uses port
12345.
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-716">
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEW_SERVER</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(COLLECTOR)</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEW_SERVER_ARGS</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-p</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;12345</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEW_SERVER_ENVIRONMENT</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"_CONDOR_COLLECTOR_LOG=$(LOG)/ViewServerLog"</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;DAEMON_LIST</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;MASTER,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;NEGOTIATOR,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;COLLECTOR,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEW_SERVER</tspan>
</div>
<!--l. 97--><p class="nopar" >
<!--l. 101--><p class="indent" >   For this change to take effect, restart the <span class="textit">condor_master</span> on this host. This may be accomplished with the
<span class="textit">condor_restart</span> command, if the command is run with administrator access to the pool.
<!--l. 110--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3620003.14.7"></a> Configuring a Pool to Report to the HTCondorView Server</h5>
<!--l. 113--><p class="noindent" >For the HTCondorView server to function, configure the existing collector to forward ClassAd updates to it.
This configuration is only necessary if the HTCondorView collector is a different collector from the
existing <span class="textit">condor_collector</span> for the pool. All the HTCondor daemons in the pool send their ClassAd
updates to the regular <span class="textit">condor_collector</span>, which in turn will forward them on to the HTCondorView
server.
<!--l. 122--><p class="indent" >   Define the following configuration variable:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-717">
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;CONDOR_VIEW_HOST</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;full.hostname[:portnumber]</tspan>
</div>
<!--l. 126--><p class="nopar" > where <span class="obeylines-h"><span class="verb">full.hostname</span></span> is the full host name of the machine running the HTCondorView collector. The full host
name is optionally followed by a colon and port number. This is only necessary if the HTCondorView collector is
configured to use a port number other than the default.
<!--l. 134--><p class="indent" >   Place this setting in the configuration file used by the existing <span class="textit">condor_collector</span>. It is acceptable to place it in
the global configuration file. The HTCondorView collector will ignore this setting (as it should) as it notices that it
is being asked to forward ClassAds to itself.
<!--l. 140--><p class="indent" >   Once the HTCondorView server is running with this change, send a <span class="textit">condor_reconfig</span> command to the main
<span class="textit">condor_collector</span> for the change to take effect, so it will begin forwarding updates. A query to the HTCondorView
collector will verify that it is working. A query example:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-718">
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;condor_status</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-pool</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;condor.view.host[:portnumber]</tspan>
</div>
<!--l. 150--><p class="nopar" >
<!--l. 154--><p class="indent" >   A <span class="textit">condor_collector</span> may also be configured to report to multiple HTCondorView servers. The configuration
variable <span class="texttt">CONDOR_VIEW_HOST</span> <a 
 id="dx42-362001"></a><a 
 id="dx42-362002"></a> can be given as a list of HTCondorView servers separated by commas and/or
spaces.
<!--l. 158--><p class="indent" >   The following demonstrates an example configuration for two HTCondorView servers, where both
HTCondorView servers (and the <span class="textit">condor_collector</span>) are running on the same machine, localhost.localdomain:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-719">
<tspan font-family="ectt" font-size="0800">VIEWSERV01</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(COLLECTOR)</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV01_ARGS</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-p</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;12345</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-local-name</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEWSERV01</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV01_ENVIRONMENT</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"_CONDOR_COLLECTOR_LOG=$(LOG)/ViewServerLog01"</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV01.POOL_HISTORY_DIR</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(LOCAL_DIR)/poolhist01</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV01.KEEP_POOL_HISTORY</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;TRUE</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV01.CONDOR_VIEW_HOST</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV02</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(COLLECTOR)</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV02_ARGS</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-p</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;24680</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-local-name</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEWSERV02</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV02_ENVIRONMENT</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"_CONDOR_COLLECTOR_LOG=$(LOG)/ViewServerLog02"</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV02.POOL_HISTORY_DIR</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(LOCAL_DIR)/poolhist02</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV02.KEEP_POOL_HISTORY</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;TRUE</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">VIEWSERV02.CONDOR_VIEW_HOST</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">CONDOR_VIEW_HOST</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;localhost.localdomain:12345</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;localhost.localdomain:24680</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">DAEMON_LIST</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(DAEMON_LIST)</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEWSERV01</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;VIEWSERV02</tspan>
</div>
<!--l. 180--><p class="nopar" >
<!--l. 183--><p class="indent" >   Note that the value of <span class="texttt">CONDOR_VIEW_HOST</span> <a 
 id="dx42-362003"></a><a 
 id="dx42-362004"></a> for VIEWSERV01 and VIEWSERV02 is unset, to prevent them from
inheriting the global value of <span class="texttt">CONDOR_VIEW_HOST</span> and attempting to report to themselves or each other. If the
HTCondorView servers are running on different machines where there is no global value for <span class="texttt">CONDOR_VIEW_HOST</span>, this
precaution is not required.
   <h4 class="subsectionHead"><span class="titlemark">3.14.8   </span> <a 
 id="x42-3630003.14.8"></a> Running HTCondor Jobs within a Virtual Machine</h4>
<a 
 id="dx42-363001"></a>
<!--l. 7--><p class="noindent" >HTCondor jobs are formed from executables that are compiled to execute on specific platforms. This in turn
restricts the machines within an HTCondor pool where a job may be executed. An HTCondor job may now be
executed on a virtual machine running VMware, Xen, or KVM. This allows Windows executables to run on a Linux
machine, and Linux executables to run on a Windows machine.
<!--l. 16--><p class="indent" >   In older versions of HTCondor, other parts of the system were also referred to as <span class="emph">virtual machines</span>, but in all
cases, those are now known as <span class="emph">slots</span>. A virtual machine here describes the environment in which the outside
operating system (called the host) emulates an inner operating system (called the inner virtual machine), such that
an executable appears to run directly on the inner virtual machine. In other parts of HTCondor, a <span class="emph">slot</span> (formerly
known as <span class="emph">virtual machine</span>) refers to the multiple cores of a multi-core machine. Also, be careful not to confuse the
virtual machines discussed here with the Java Virtual Machine (JVM) referenced in other parts of this manual.
Targeting an HTCondor job to run on an inner virtual machine is also different than using the <span class="textbf">vm</span> universe. The
<span class="textbf">vm</span> universe lands and starts up a virtual machine instance, which is the HTCondor job, on an execute
machine.
<!--l. 35--><p class="indent" >   HTCondor has the flexibility to run a job on either the host or the inner virtual machine, hence two platforms
appear to exist on a single machine. Since two platforms are an illusion, HTCondor understands the illusion,
                                                                                         

                                                                                         
allowing an HTCondor job to be executed on only one at a time.
<!--l. 44--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3640003.14.8"></a> Installation and Configuration</h5>
<a 
 id="dx42-364001"></a>
<!--l. 48--><p class="noindent" >HTCondor must be separately installed, separately configured, and separately running on both the host and the
inner virtual machine.
<!--l. 52--><p class="indent" >   The configuration for the host specifies <span class="texttt">VMP_VM_LIST</span> <a 
 id="dx42-364002"></a><a 
 id="dx42-364003"></a>. This specifies host names or IP addresses of all inner
virtual machines running on this host. An example configuration on the host machine:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-720">
<tspan font-family="ectt" font-size="0800">VMP_VM_LIST</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;vmware1.domain.com,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;vmware2.domain.com</tspan>
</div>
<!--l. 60--><p class="nopar" >
<!--l. 64--><p class="indent" >   The configuration for each separate inner virtual machine specifies <span class="texttt">VMP_HOST_MACHINE</span> <a 
 id="dx42-364004"></a><a 
 id="dx42-364005"></a>. This specifies the host
for the inner virtual machine. An example configuration on an inner virtual machine:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-721">
<tspan font-family="ectt" font-size="0800">VMP_HOST_MACHINE</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;host.domain.com</tspan>
</div>
<!--l. 72--><p class="nopar" >
<!--l. 75--><p class="indent" >   Given this configuration, as well as communication between HTCondor daemons running on the host and on the
inner virtual machine, the policy for when jobs may execute is set by HTCondor. While the host is executing an
HTCondor job, the <span class="texttt">START</span> policy on the inner virtual machine is overridden with <span class="texttt">False</span>, so no HTCondor jobs will
be started on the inner virtual machine. Conversely, while the inner virtual machine is executing an HTCondor job,
the <span class="texttt">START</span> policy on the host is overridden with <span class="texttt">False</span>, so no HTCondor jobs will be started on the
host.
<!--l. 87--><p class="indent" >   The inner virtual machine is further provided with a new syntax for referring to the machine ClassAd attributes
of its host. Any machine ClassAd attribute with a prefix of the string <span class="texttt">HOST_</span> explicitly refers to the host&#8217;s ClassAd
attributes. The <span class="texttt">START</span> policy on the inner virtual machine ought to use this syntax to avoid starting jobs when
its host is too busy processing other items. An example configuration for <span class="texttt">START</span> on an inner virtual
machine:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-722">
<tspan font-family="ectt" font-size="0800">START</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(KeyboardIdle</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003E;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;150</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;)</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&amp;&amp;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;HOST_KeyboardIdle</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003E;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;150</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;)</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&amp;&amp;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;LoadAvg</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003C;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;0.3</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;)</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&amp;&amp;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;HOST_TotalLoadAvg</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003C;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;0.3</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;)</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;)</tspan>
</div>
<!--l. 100--><p class="nopar" >
<!--l. 3--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.9   </span> <a 
 id="x42-3650003.14.9"></a> HTCondor&#8217;s Dedicated Scheduling</h4>
<a 
 id="dx42-365001"></a>
<a 
 id="dx42-365002"></a>
<!--l. 8--><p class="noindent" >The dedicated scheduler is a part of the <span class="textit">condor_schedd</span> that handles the scheduling of parallel jobs that require
more than one machine concurrently running per job. MPI applications are a common use for the
dedicated scheduler, but parallel applications which do not require MPI can also be run with the dedicated
scheduler. All jobs which use the parallel universe are routed to the dedicated scheduler within the
<span class="textit">condor_schedd</span> they were submitted to. A default HTCondor installation does not configure a dedicated
scheduler; the administrator must designate one or more <span class="textit">condor_schedd</span> daemons to perform as dedicated
scheduler.
<!--l. 23--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3660003.14.9"></a> Selecting and Setting Up a Dedicated Scheduler</h5>
<!--l. 26--><p class="noindent" >We recommend that you select a single machine within an HTCondor pool to act as the dedicated scheduler. This
becomes the machine from upon which all users submit their parallel universe jobs. The perfect choice for the
dedicated scheduler is the single, front-end machine for a dedicated cluster of compute nodes. For the pool without
an obvious choice for a submit machine, choose a machine that all users can log into, as well as one that is likely to
be up and running all the time. All of HTCondor&#8217;s other resource requirements for a submit machine apply to this
machine, such as having enough disk space in the spool directory to hold jobs. See section&#x00A0;<a 
href="InstallationStartUpShutDownandReconfiguration.html#x30-1540003.2.2">3.2.2<!--tex4ht:ref: sec:Preparing-to-Install --></a> on page&#x00A0;<a 
href="InstallationStartUpShutDownandReconfiguration.html#x30-1540003.2.2">463<!--tex4ht:ref: sec:Preparing-to-Install --></a> for
details on these issues.
<!--l. 43--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3670003.14.9"></a> Configuration Examples for Dedicated Resources</h5>
<!--l. 46--><p class="noindent" >Each execute machine may have its own policy for the execution of jobs, as set by configuration. Each
machine with aspects of its configuration that are dedicated identifies the dedicated scheduler. And,
                                                                                         

                                                                                         
the ClassAd representing a job to be executed on one or more of these dedicated machines includes
an identifying attribute. An example configuration file with the following various policy settings is
<span class="texttt">/etc/examples/condor_config.local.dedicated.resource</span>.
<!--l. 55--><p class="indent" >   Each execute machine defines the configuration variable <span class="texttt">DedicatedScheduler</span> <a 
 id="dx42-367001"></a><a 
 id="dx42-367002"></a>, which identifies the dedicated
scheduler it is managed by. The local configuration file contains a modified form of
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-723">
<tspan font-family="ectt" font-size="1000">DedicatedScheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"DedicatedScheduler@full.host.name"</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">STARTD_ATTRS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(STARTD_ATTRS),</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;DedicatedScheduler</tspan>
</div>
<!--l. 63--><p class="nopar" >
<!--l. 65--><p class="indent" >   Substitute the host name of the dedicated scheduler machine for the string "<span class="obeylines-h"><span class="verb">full.host.name</span></span>".
<!--l. 68--><p class="indent" >   If running personal HTCondor, the name of the scheduler includes the user name it was started as, so the
configuration appears as:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-724">
<tspan font-family="ectt" font-size="1000">DedicatedScheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"DedicatedScheduler@username@full.host.name"</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">STARTD_ATTRS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(STARTD_ATTRS),</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;DedicatedScheduler</tspan>
</div>
<!--l. 74--><p class="nopar" >
<!--l. 76--><p class="indent" >   All dedicated execute machines must have policy expressions which allow for jobs to always run, but
not be preempted. The resource must also be configured to prefer jobs from the dedicated scheduler
over all other jobs. Therefore, configuration gives the dedicated scheduler of choice the highest rank.
It is worth noting that HTCondor puts no other requirements on a resource for it to be considered
dedicated.
<!--l. 85--><p class="indent" >   Job ClassAds from the dedicated scheduler contain the attribute <span class="texttt">Scheduler</span>. The attribute is defined by a string
of the form
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-725">
<tspan font-family="ectt" font-size="1000">Scheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"DedicatedScheduler@full.host.name"</tspan>
</div>
<!--l. 90--><p class="nopar" > The host name of the dedicated scheduler substitutes for the string <span class="obeylines-h"><span class="verb">full.host.name</span></span>.
<!--l. 94--><p class="indent" >   Different resources in the pool may have different dedicated policies by varying the local configuration.
     <dl class="description"><dt class="description">
Policy Scenario: Machine Runs Only Jobs That Require Dedicated Resources </dt><dd 
class="description">
     <!--l. 101--><p class="noindent" >One possible scenario for the use of a dedicated resource is to only run jobs that require the dedicated
     resource. To enact this policy, configure the following expressions:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-726">
     <tspan font-family="ectt" font-size="1000">START</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Scheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=?=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(DedicatedScheduler)</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SUSPEND</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;False</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">CONTINUE</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">PREEMPT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;False</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">KILL</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;False</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">WANT_SUSPEND</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;False</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">WANT_VACATE</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;False</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">RANK</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Scheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=?=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(DedicatedScheduler)</tspan>
</div>
     <!--l. 114--><p class="nopar" >
     <!--l. 116--><p class="noindent" >The <span class="texttt">START</span> <a 
 id="dx42-367003"></a><a 
 id="dx42-367004"></a> expression specifies that a job with the <span class="texttt">Scheduler</span> attribute must match the string corresponding
     <span class="texttt">DedicatedScheduler</span> attribute in the machine ClassAd. The <span class="texttt">RANK</span> <a 
 id="dx42-367005"></a><a 
 id="dx42-367006"></a> expression specifies that this same job
     (with the <span class="texttt">Scheduler</span> attribute) has the highest rank. This prevents other jobs from preempting it based on
     user priorities. The rest of the expressions disable any other of the <span class="textit">condor_startd</span> daemon&#8217;s pool-wide
     policies, such as those for evicting jobs when keyboard and CPU activity is discovered on the
     machine.
     </dd><dt class="description">
Policy Scenario: Run Both Jobs That Do and Do Not Require Dedicated Resources </dt><dd 
class="description">
     <!--l. 132--><p class="noindent" >While the first example works nicely for jobs requiring dedicated resources, it can lead to poor utilization of
     the dedicated machines. A more sophisticated strategy allows the machines to run other jobs, when no jobs
     that require dedicated resources exist. The machine is configured to prefer jobs that require dedicated
     resources, but not prevent others from running.
     <!--l. 143--><p class="noindent" >To implement this, configure the machine as a dedicated resource as above, modifying only the <span class="texttt">START</span>
     expression:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-727">
     <tspan font-family="ectt" font-size="1000">START</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
</div>
     <!--l. 149--><p class="nopar" >
     </dd><dt class="description">
Policy Scenario: Adding Desktop Resources To The Mix </dt><dd 
class="description">
     <!--l. 154--><p class="noindent" >A third policy example allows all jobs. These desktop machines use a preexisting <span class="texttt">START</span> expression that takes
     the machine owner&#8217;s usage into account for some jobs. The machine does not preempt jobs that must run on
     dedicated resources, while it may preempt other jobs as defined by policy. So, the default pool policy is used
     for starting and stopping jobs, while jobs that require a dedicated resource always start and are not
     preempted.
     <!--l. 164--><p class="noindent" >The <span class="texttt">START</span>, <span class="texttt">SUSPEND</span>, <span class="texttt">PREEMPT</span>, and <span class="texttt">RANK</span> policies are set in the global configuration. Locally, the configuration
     is modified to this hybrid policy by adding a second case.
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-728">
     <tspan font-family="ectt" font-size="1000">SUSPEND</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Scheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=!=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(DedicatedScheduler)</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;&amp;&amp;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;($(SUSPEND))</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">PREEMPT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Scheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=!=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(DedicatedScheduler)</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;&amp;&amp;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;($(PREEMPT))</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">RANK_FACTOR</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;1000000</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">RANK</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(Scheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=?=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(DedicatedScheduler)</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;*</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(RANK_FACTOR))</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;\</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;+</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(RANK)</tspan>
     <tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">START</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(Scheduler</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=?=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(DedicatedScheduler))</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;||</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;($(START))</tspan>
</div>
     <!--l. 176--><p class="nopar" >
     <!--l. 178--><p class="noindent" >Define <span class="texttt">RANK_FACTOR</span> <a 
 id="dx42-367007"></a><a 
 id="dx42-367008"></a> to be a larger value than the maximum value possible for the existing
     rank expression. <span class="texttt">RANK</span> <a 
 id="dx42-367009"></a><a 
 id="dx42-367010"></a> is a floating point value, so there is no harm in assigning a very large
     value.
     </dd></dl>
<!--l. 187--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3680003.14.9"></a> Preemption with Dedicated Jobs</h5>
<!--l. 190--><p class="noindent" >The dedicated scheduler can be configured to preempt running parallel universe jobs in favor of higher priority
parallel universe jobs. Note that this is different from preemption in other universes, and parallel universe jobs
cannot be preempted either by a machine&#8217;s user pressing a key or by other means.
<!--l. 197--><p class="indent" >   By default, the dedicated scheduler will never preempt running parallel universe jobs. Two configuration
variables control preemption of these dedicated resources: <span class="texttt">SCHEDD_PREEMPTION_REQUIREMENTS</span> <a 
 id="dx42-368001"></a><a 
 id="dx42-368002"></a> and
<span class="texttt">SCHEDD_PREEMPTION_RANK</span> <a 
 id="dx42-368003"></a><a 
 id="dx42-368004"></a>. These variables have no default value, so if either are not defined, preemption will never
occur. <span class="texttt">SCHEDD_PREEMPTION_REQUIREMENTS</span> must evaluate to <span class="texttt">True</span> for a machine to be a candidate for this kind of
preemption. If more machines are candidates for preemption than needed to satisfy a higher priority
job, the machines are sorted by <span class="texttt">SCHEDD_PREEMPTION_RANK</span>, and only the highest ranked machines are
taken.
<!--l. 212--><p class="indent" >   Note that preempting one node of a running parallel universe job requires killing the entire job on all of its
nodes. So, when preemption occurs, it may end up freeing more machines than are needed for the new job. Also, as
HTCondor does not produce checkpoints for parallel universe jobs, preempted jobs will be re-run, starting again
from the beginning. Thus, the administrator should be careful when enabling preemption of these dedicated
resources. Enable dedicated preemption with the configuration:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-729">
<tspan font-family="ectt" font-size="1000">STARTD_JOB_EXPRS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;JobPrio</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SCHEDD_PREEMPTION_REQUIREMENTS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(My.JobPrio</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;&#x003C;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Target.JobPrio)</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SCHEDD_PREEMPTION_RANK</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;0.0</tspan>
</div>
<!--l. 226--><p class="nopar" >
<!--l. 228--><p class="indent" >   In this example, preemption is enabled by user-defined job priority. If a set of machines is running a job at user
priority 5, and the user submits a new job at user priority 10, the running job will be preempted for the new job.
The old job is put back in the queue, and will begin again from the beginning when assigned to a newly acquired set
of machines.
<!--l. 237--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3690003.14.9"></a> Grouping Dedicated Nodes into Parallel Scheduling Groups</h5>
<a 
 id="dx42-369001"></a>
<!--l. 241--><p class="noindent" >In some parallel environments, machines are divided into groups, and jobs should not cross groups of machines.
That is, all the nodes of a parallel job should be allocated to machines within the same group. The most common
example is a pool of machine using InfiniBand switches. For example, each switch might connect 16 machines, and a
pool might have 160 machines on 10 switches. If the InfiniBand switches are not routed to each other, each job must
run on machines connected to the same switch. The dedicated scheduler&#8217;s <span class="emph">Parallel Scheduling Groups</span> feature
supports this operation.
<!--l. 254--><p class="indent" >   Each <span class="textit">condor_startd</span> must define which group it belongs to by setting the <span class="texttt">ParallelSchedulingGroup</span> <a 
 id="dx42-369002"></a><a 
 id="dx42-369003"></a> variable in
the configuration file, and advertising it into the machine ClassAd. The value of this variable is a string, which
should be the same for all <span class="textit">condor_startd</span> daemons within a given group. The property must be advertised in the
<span class="textit">condor_startd</span> ClassAd by appending <span class="texttt">ParallelSchedulingGroup</span> to the <span class="texttt">STARTD_ATTRS</span> <a 
 id="dx42-369004"></a><a 
 id="dx42-369005"></a> configuration
variable.
<!--l. 263--><p class="indent" >   The submit description file for a parallel universe job which must not cross group boundaries contains
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-730">
<tspan font-family="ectt" font-size="1000">+WantParallelSchedulingGroups</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
</div>
<!--l. 267--><p class="nopar" >
<!--l. 269--><p class="indent" >   The dedicated scheduler enforces the allocation to within a group.
<!--l. 2--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.10   </span> <a 
 id="x42-3700003.14.10"></a>Configuring HTCondor for Running Backfill Jobs</h4>
<a 
 id="dx42-370001"></a>
<!--l. 7--><p class="noindent" >HTCondor can be configured to run backfill jobs whenever the <span class="textit">condor_startd</span> has no other work to perform. These
jobs are considered the lowest possible priority, but when machines would otherwise be idle, the resources can be put
to good use.
<!--l. 14--><p class="indent" >   Currently, HTCondor only supports using the Berkeley Open Infrastructure for Network Computing (BOINC) to
provide the backfill jobs. More information about BOINC is available at <a 
href="http://boinc.berkeley.edu" >http://boinc.berkeley.edu</a>.
<!--l. 19--><p class="indent" >   The rest of this section provides an overview of how backfill jobs work in HTCondor, details for configuring the
policy for when backfill jobs are started or killed, and details on how to configure HTCondor to spawn the BOINC
client to perform the work.
<!--l. 27--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3710003.14.10"></a>Overview of Backfill jobs in HTCondor</h5>
<a 
 id="dx42-371001"></a>
<!--l. 32--><p class="noindent" >Whenever a resource controlled by HTCondor is in the Unclaimed/Idle state, it is totally idle; neither the interactive
user nor an HTCondor job is performing any work. Machines in this state can be configured to enter the <span class="emph">Backfill</span>
state, which allows the resource to attempt a background computation to keep itself busy until other work arrives
(either a user returning to use the machine interactively, or a normal HTCondor job). Once a resource enters the
Backfill state, the <span class="textit">condor_startd</span> will attempt to spawn another program, called a <span class="emph">backfill client</span>, to launch and
manage the backfill computation. When other work arrives, the <span class="textit">condor_startd</span> will kill the backfill client and clean
up any processes it has spawned, freeing the machine resources for the new, higher priority task. More
details about the different states an HTCondor resource can enter and all of the possible transitions
between them are described in section&#x00A0;<a 
href="PolicyConfigurationforExecuteHostsandforSubmitHosts.html#x35-2410003.7">3.7<!--tex4ht:ref: sec:Configuring-Policy --></a> beginning on page&#x00A0;<a 
href="PolicyConfigurationforExecuteHostsandforSubmitHosts.html#x35-2410003.7">858<!--tex4ht:ref: sec:Configuring-Policy --></a>, especially sections&#x00A0;<a 
href="PolicyConfigurationforExecuteHostsandforSubmitHosts.html#x35-2470003.7.1">3.7.1<!--tex4ht:ref: sec:States --></a>, <a 
href="PolicyConfigurationforExecuteHostsandforSubmitHosts.html#x35-2490003.7.1">3.7.1<!--tex4ht:ref: sec:Activities --></a>, and
<a 
href="PolicyConfigurationforExecuteHostsandforSubmitHosts.html#x35-2500003.7.1">3.7.1<!--tex4ht:ref: sec:State-and-Activity-Transitions --></a>.
<!--l. 53--><p class="indent" >   At this point, the only backfill system supported by HTCondor is BOINC. The <span class="textit">condor_startd</span> has the ability to
                                                                                         

                                                                                         
start and stop the BOINC client program at the appropriate times, but otherwise provides no additional services to
configure the BOINC computations themselves. Future versions of HTCondor might provide additional
functionality to make it easier to manage BOINC computations from within HTCondor. For now, the
BOINC client must be manually installed and configured outside of HTCondor on each backfill-enabled
machine.
<!--l. 64--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3720003.14.10"></a>Defining the Backfill Policy</h5>
<a 
 id="dx42-372001"></a>
<!--l. 69--><p class="noindent" >There are a small set of policy expressions that determine if a <span class="textit">condor_startd</span> will attempt to spawn a backfill client
at all, and if so, to control the transitions in to and out of the Backfill state. This section briefly lists these
expressions. More detail can be found in section&#x00A0;<a 
href="ConfigurationMacros.html#x33-1950003.5.8">3.5.8<!--tex4ht:ref: sec:Startd-Config-File-Entries --></a> on page&#x00A0;<a 
href="ConfigurationMacros.html#x33-1950003.5.8">648<!--tex4ht:ref: sec:Startd-Config-File-Entries --></a>.
     <dl class="description"><dt class="description">
<span class="texttt">ENABLE_BACKFILL</span> <a 
 id="dx42-372002"></a><a 
 id="dx42-372003"></a> </dt><dd 
class="description">A boolean value to determine if any backfill functionality should be used. The default
     value is <span class="texttt">False</span>.
     </dd><dt class="description">
<span class="texttt">BACKFILL_SYSTEM</span> <a 
 id="dx42-372004"></a><a 
 id="dx42-372005"></a> </dt><dd 
class="description">A string that defines what backfill system to use for spawning and managing backfill
     computations. Currently, the only supported string is <span class="texttt">"BOINC"</span>.
     </dd><dt class="description">
<span class="texttt">START_BACKFILL</span> <a 
 id="dx42-372006"></a><a 
 id="dx42-372007"></a> </dt><dd 
class="description">A boolean expression to control if an HTCondor resource should start a backfill client. This
     expression is only evaluated when the machine is in the Unclaimed/Idle state and the <span class="texttt">ENABLE_BACKFILL</span>
     expression is <span class="texttt">True</span>.
     </dd><dt class="description">
<span class="texttt">EVICT_BACKFILL</span> <a 
 id="dx42-372008"></a><a 
 id="dx42-372009"></a> </dt><dd 
class="description">A boolean expression that is evaluated whenever an HTCondor resource is in the Backfill
     state. A value of <span class="texttt">True</span> indicates the machine should immediately kill the currently running backfill
     client and any other spawned processes, and return to the Owner state.
     </dd></dl>
<!--l. 100--><p class="indent" >   The following example shows a possible configuration to enable backfill:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-731">
<tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Turn</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;on</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;backfill</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;functionality,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;and</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;use</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;BOINC</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">ENABLE_BACKFILL</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;TRUE</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BACKFILL_SYSTEM</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;BOINC</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Spawn</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;a</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;backfill</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;job</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;if</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;we</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">ve</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;been</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Unclaimed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;for</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;more</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;than</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;5</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;minutes</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">START_BACKFILL</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(StateTimer)</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003E;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(5</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;*</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(MINUTE))</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Evict</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;a</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;backfill</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;job</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;if</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;machine</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;is</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;busy</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(based</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;on</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;keyboard</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;activity</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;or</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;cpu</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;load)</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">EVICT_BACKFILL</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(MachineBusy)</tspan>
</div>
<!--l. 116--><p class="nopar" >
<!--l. 122--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3730003.14.10"></a>Overview of the BOINC system</h5>
<a 
 id="dx42-373001"></a>
<!--l. 127--><p class="noindent" >The BOINC system is a distributed computing environment for solving large scale scientific problems. A detailed
explanation of this system is beyond the scope of this manual. Thorough documentation about BOINC is available
at their website: <a 
href="http://boinc.berkeley.edu" >http://boinc.berkeley.edu</a>. However, a brief overview is provided here for sites interested in using
BOINC with HTCondor to manage backfill jobs.
<!--l. 136--><p class="indent" >   BOINC grew out of the relatively famous SETI@home computation, where volunteers installed special client
software, in the form of a screen saver, that contacted a centralized server to download work units. Each work unit
contained a set of radio telescope data and the computation tried to find patterns in the data, a sign of intelligent
life elsewhere in the universe, hence the name: "Search for Extra Terrestrial Intelligence at home". BOINC is
developed by the Space Sciences Lab at the University of California, Berkeley, by the same people who created
SETI@home. However, instead of being tied to the specific radio telescope application, BOINC is a generic
infrastructure by which many different kinds of scientific computations can be solved. The current generation of
SETI@home now runs on top of BOINC, along with various physics, biology, climatology, and other
applications.
<!--l. 152--><p class="indent" >   The basic computational model for BOINC and the original SETI@home is the same: volunteers install
BOINC client software, called the <span class="textit">boinc_client</span>, which runs whenever the machine would otherwise be
idle. However, the BOINC installation on any given machine must be configured so that it knows
what computations to work for instead of always working on a hard coded computation. The BOINC
terminology for a computation is a <span class="emph">project</span>. A given BOINC client can be configured to donate all of
its cycles to a single project, or to split the cycles between projects so that, on average, the desired
percentage of the computational power is allocated to each project. Once the <span class="textit">boinc_client</span> starts running, it
attempts to contact a centralized server for each project it has been configured to work for. The BOINC
software downloads the appropriate platform-specific application binary and some work units from the
                                                                                         

                                                                                         
central server for each project. Whenever the client software completes a given work unit, it once
again attempts to connect to that project&#8217;s central server to upload the results and download more
work.
<!--l. 174--><p class="indent" >   BOINC participants must register at the centralized server for each project they wish to donate cycles to. The
process produces a unique identifier so that the work performed by a given client can be credited to a specific user.
BOINC keeps track of the work units completed by each user, so that users providing the most cycles get the
highest rankings, and therefore, bragging rights.
<!--l. 182--><p class="indent" >   Because BOINC already handles the problems of distributing the application binaries for each scientific
computation, the work units, and compiling the results, it is a perfect system for managing backfill
computations in HTCondor. Many of the applications that run on top of BOINC produce their own
application-specific checkpoints, so even if the <span class="textit">boinc_client</span> is killed, for example, when an HTCondor job
arrives at a machine, or if the interactive user returns, an entire work unit will not necessarily be
lost.
<!--l. 196--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3740003.14.10"></a>Installing the BOINC client software</h5>
<a 
 id="dx42-374001"></a>
<!--l. 201--><p class="noindent" >In HTCondor Version 8.9.1, the <span class="textit">boinc_client</span> must be manually downloaded, installed and configured outside of
HTCondor. Download the <span class="textit">boinc_client</span> executables at <a 
href="http://boinc.berkeley.edu/download.php" >http://boinc.berkeley.edu/download.php</a>.
<!--l. 210--><p class="indent" >   Once the BOINC client software has been downloaded, the <span class="textit">boinc_client</span> binary should be placed in a location
where the HTCondor daemons can use it. The path will be specified with the HTCondor configuration variable
<span class="texttt">BOINC_Executable</span> <a 
 id="dx42-374002"></a><a 
 id="dx42-374003"></a>.
<!--l. 216--><p class="indent" >   Additionally, a local directory on each machine should be created where the BOINC system can write files it
needs. This directory must not be shared by multiple instances of the BOINC software. This is the
same restriction as placed on the <span class="texttt">spool</span> or <span class="texttt">execute</span> directories used by HTCondor. The location of
this directory is defined by <span class="texttt">BOINC_InitialDir</span> <a 
 id="dx42-374004"></a><a 
 id="dx42-374005"></a>. The directory must be writable by whatever user
the <span class="textit">boinc_client</span> will run as. This user is either the same as the user the HTCondor daemons are
running as, if HTCondor is not running as root, or a user defined via the <span class="texttt">BOINC_Owner</span> <a 
 id="dx42-374006"></a><a 
 id="dx42-374007"></a> configuration
variable.
<!--l. 229--><p class="indent" >   Finally, HTCondor administrators wishing to use BOINC for backfill jobs must create accounts at the various
BOINC projects they want to donate cycles to. The details of this process vary from project to project. Beware that
this step must be done manually, as the <span class="textit">boinc_client</span> can not automatically register a user at a given project,
unlike the more fancy GUI version of the BOINC client software which many users run as a screen
saver. For example, to configure machines to perform work for the Einstein@home project (a physics
experiment run by the University of Wisconsin at Milwaukee), HTCondor administrators should go to
<a 
href="http://einstein.phys.uwm.edu/create_account_form.php" >http://einstein.phys.uwm.edu/create_account_form.php</a>, fill in the web form, and generate a new Einstein@home
identity. This identity takes the form of a project URL (such as http://einstein.phys.uwm.edu) followed
by an <span class="emph">account key</span>, which is a long string of letters and numbers that is used as a unique identifier.
This URL and account key will be needed when configuring HTCondor to use BOINC for backfill
                                                                                         

                                                                                         
computations.
<!--l. 253--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3750003.14.10"></a>Configuring the BOINC client under HTCondor</h5>
<a 
 id="dx42-375001"></a>
<!--l. 258--><p class="noindent" >After the <span class="textit">boinc_client</span> has been installed on a given machine, the BOINC projects to join have been selected, and a
unique project account key has been created for each project, the HTCondor configuration needs to be
modified.
<!--l. 264--><p class="indent" >   Whenever the <span class="textit">condor_startd</span> decides to spawn the <span class="textit">boinc_client</span> to perform backfill computations, it will spawn a
<span class="textit">condor_starter</span> to directly launch and monitor the <span class="textit">boinc_client</span> program. This <span class="textit">condor_starter</span> is just like the one
used to invoke any other HTCondor jobs. In fact, the argv[0] of the <span class="textit">boinc_client</span> will be renamed to <span class="textit">condor_exec</span>, as
described in section&#x00A0;<a 
href="PotentialProblems.html#x27-1460002.15.1">2.15.1<!--tex4ht:ref: sec:renaming-argv --></a> on page&#x00A0;<a 
href="PotentialProblems.html#x27-1460002.15.1">446<!--tex4ht:ref: sec:renaming-argv --></a>.
<!--l. 274--><p class="indent" >   This <span class="textit">condor_starter</span> reads values out of the HTCondor configuration files to define the job it should run, as
opposed to getting these values from a job ClassAd in the case of a normal HTCondor job. All of
the configuration variables names for variables to control things such as the path to the <span class="textit">boinc_client</span>
binary to use, the command-line arguments, and the initial working directory, are prefixed with the
string <span class="texttt">"BOINC_"</span>. Each of these variables is described as either a required or an optional configuration
variable.
<!--l. 286--><p class="indent" >   Required configuration variables:
     <dl class="description"><dt class="description">
<span class="texttt">BOINC_Executable</span> <a 
 id="dx42-375002"></a><a 
 id="dx42-375003"></a> </dt><dd 
class="description"> The full path and executable name of the <span class="textit">boinc_client</span> binary to use.
     </dd><dt class="description">
<span class="texttt">BOINC_InitialDir</span> <a 
 id="dx42-375004"></a><a 
 id="dx42-375005"></a> </dt><dd 
class="description"> The full path to the local directory where BOINC should run.
     </dd><dt class="description">
<span class="texttt">BOINC_Universe</span> <a 
 id="dx42-375006"></a><a 
 id="dx42-375007"></a> </dt><dd 
class="description"> The HTCondor universe used for running the <span class="textit">boinc_client</span> program. This <span class="emph">must</span> be set
     to <span class="texttt">vanilla</span> for BOINC to work under HTCondor.
     </dd><dt class="description">
<span class="texttt">BOINC_Owner</span> <a 
 id="dx42-375008"></a><a 
 id="dx42-375009"></a> </dt><dd 
class="description"> What user the <span class="textit">boinc_client</span> program should be run as. This variable is only used if the
     HTCondor daemons are running as root. In this case, the <span class="textit">condor_starter</span> must be told what user
     identity to switch to before invoking the <span class="textit">boinc_client</span>. This can be any valid user on the local system,
     but it must have write permission in whatever directory is specified by <span class="texttt">BOINC_InitialDir</span>.
     </dd></dl>
<!--l. 312--><p class="indent" >   Optional configuration variables:
                                                                                         

                                                                                         
     <dl class="description"><dt class="description">
<span class="texttt">BOINC_Arguments</span> <a 
 id="dx42-375010"></a><a 
 id="dx42-375011"></a> </dt><dd 
class="description"> Command-line  arguments  that  should  be  passed  to  the  <span class="textit">boinc_client</span> program.  For
     example, one way to specify the BOINC project to join is to use the <span class="textbf">&#8211;attach_project</span> argument to
     specify a project URL and account key. For example:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-732">
     <tspan font-family="ectt" font-size="0800">BOINC_Arguments</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;--attach_project</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;http://einstein.phys.uwm.edu</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;[account_key]</tspan>
</div>
     <!--l. 327--><p class="nopar" >
     </dd><dt class="description">
<span class="texttt">BOINC_Environment</span> <a 
 id="dx42-375012"></a><a 
 id="dx42-375013"></a> </dt><dd 
class="description"> Environment variables that should be set for the <span class="textit">boinc_client</span>.
     </dd><dt class="description">
<span class="texttt">BOINC_Output</span> <a 
 id="dx42-375014"></a><a 
 id="dx42-375015"></a> </dt><dd 
class="description"> Full path to the file where <span class="texttt">stdout</span> from the <span class="textit">boinc_client</span> should be written. If this variable is not
     defined, <span class="texttt">stdout</span> will be discarded.
     </dd><dt class="description">
<span class="texttt">BOINC_Error</span> <a 
 id="dx42-375016"></a><a 
 id="dx42-375017"></a> </dt><dd 
class="description"> Full path to the file where <span class="texttt">stderr</span> from the <span class="textit">boinc_client</span> should be written. If this macro is not
     defined, <span class="texttt">stderr</span> will be discarded.
     </dd></dl>
<!--l. 347--><p class="indent" >   The following example shows one possible usage of these settings:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-733">
<tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Define</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;a</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;shared</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;macro</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;that</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;can</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;be</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;used</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;define</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;other</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;settings.</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;This</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;directory</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;must</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;be</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;manually</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;created</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;before</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;attempting</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;run</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;any</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;backfill</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;jobs.</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BOINC_HOME</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(LOCAL_DIR)/boinc</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Path</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;boinc_client</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;use,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;and</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;required</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;universe</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;setting</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BOINC_Executable</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/usr/local/bin/boinc_client</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BOINC_Universe</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;vanilla</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;What</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;initial</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;working</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;directory</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;should</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;BOINC</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;use?</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BOINC_InitialDir</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(BOINC_HOME)</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Where</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;place</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;stdout</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;and</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;stderr</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BOINC_Output</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(BOINC_HOME)/boinc.out</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BOINC_Error</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(BOINC_HOME)/boinc.err</tspan>
</div>
<!--l. 366--><p class="nopar" >
<!--l. 369--><p class="indent" >   If the HTCondor daemons reading this configuration are running as root, an additional variable must be
defined:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-734">
<tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Specify</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;user</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;that</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;boinc_client</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;should</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;run</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;as:</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">BOINC_Owner</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;nobody</tspan>
</div>
<!--l. 376--><p class="nopar" >
<!--l. 379--><p class="indent" >   In this case, HTCondor would spawn the <span class="textit">boinc_client</span> as nobody, so the directory specified in <span class="texttt">$(BOINC_HOME)</span>
would have to be writable by the nobody user.
<!--l. 383--><p class="indent" >   A better choice would probably be to create a separate user account just for running BOINC jobs, so that the
local BOINC installation is not writable by other processes running as nobody. Alternatively, the <span class="texttt">BOINC_Owner</span>
could be set to daemon.
<!--l. 389--><p class="noindent" ><span class="textbf">Attaching to a specific BOINC project</span>
<!--l. 391--><p class="indent" >   There are a few ways to attach an HTCondor/BOINC installation to a given BOINC project:
     <ul class="itemize1">
     <li class="itemize">Use the <span class="textbf">&#8211;attach_project</span> argument to the <span class="textit">boinc_client</span> program, defined via the <span class="texttt">BOINC_Arguments</span>
     variable. The <span class="textit">boinc_client</span> will only accept a single <span class="textbf">&#8211;attach_project</span> argument, so this method can
     only be used to attach to one project.
     </li>
     <li class="itemize">The  <span class="textit">boinc_cmd</span>  command-line  tool  can  perform  various  BOINC  administrative  tasks,  including
     attaching  to  a  BOINC  project.  Using  <span class="textit">boinc_cmd</span>,  the  appropriate  argument  to  use  is  called
     <span class="textbf">&#8211;project_attach</span>. Unfortunately, the <span class="textit">boinc_client</span> must be running for <span class="textit">boinc_cmd</span> to work, so this
     method can only be used once the HTCondor resource has entered the Backfill state and has spawned
     the <span class="textit">boinc_client</span>.
     </li>
     <li class="itemize">Manually  create  account  files  in  the  local  BOINC  directory.  Upon  start  up,  the  <span class="textit">boinc_client</span>
     will scan its local directory (the directory specified with <span class="texttt">BOINC_InitialDir</span>) for files of the form
     <span class="texttt">account_[URL].xml</span>, for example, <span class="texttt">account_einstein.phys.uwm.edu.xml</span>. Any files with a name that
     matches this convention will be read and processed. The contents of the file define the project URL
     and the authentication key. The format is:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-735">
     <tspan font-family="ectt" font-size="0800">&#x003C;account&#x003E;</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003C;master_url&#x003E;[URL]&#x003C;/master_url&#x003E;</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003C;authenticator&#x003E;[key]&#x003C;/authenticator&#x003E;</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x003C;/account&#x003E;</tspan>
</div>
     <!--l. 427--><p class="nopar" >
     <!--l. 430--><p class="noindent" >For example:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-736">
     <tspan font-family="ectt" font-size="0800">&#x003C;account&#x003E;</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003C;master_url&#x003E;http://einstein.phys.uwm.edu&#x003C;/master_url&#x003E;</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003C;authenticator&#x003E;aaaa1111bbbb2222cccc3333&#x003C;/authenticator&#x003E;</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x003C;/account&#x003E;</tspan>
</div>
     <!--l. 438--><p class="nopar" >
     <!--l. 441--><p class="noindent" >Of course, the <span class="obeylines-h"><span class="verb">&#x003C;authenticator&#x003E;</span></span> tag would use the real authentication key returned when the account was
     created at a given project.
     <!--l. 445--><p class="noindent" >These account files can be copied to the local BOINC directory on all machines in an HTCondor pool, so
     administrators can either distribute them manually, or use symbolic links to point to a shared file
     system.
     </li></ul>
<!--l. 452--><p class="indent" >   In the two cases of using command-line arguments for <span class="textit">boinc_client</span> or running the <span class="textit">boinc_cmd</span> tool, BOINC will
write out the resulting account file to the local BOINC directory on the machine, and then future invocations of the
<span class="textit">boinc_client</span> will already be attached to the appropriate project(s).
<!--l. 464--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x42-3760003.14.10"></a>BOINC on Windows</h5>
<!--l. 467--><p class="noindent" >The Windows version of BOINC has multiple installation methods. The preferred method of installation for use
with HTCondor is the Shared Installation method. Using this method gives all users access to the executables.
During the installation process
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x42-376002x1">Deselect the option which makes BOINC the default screen saver
     </li>
     <li 
  class="enumerate" id="x42-376004x2">Deselect the option which runs BOINC on start up.
     </li>
     <li 
  class="enumerate" id="x42-376006x3">Do not launch BOINC at the conclusion of the installation.</li></ol>
<!--l. 481--><p class="indent" >   There are three major differences from the Unix version to keep in mind when dealing with the Windows
installation:
<!--l. 484--><p class="indent" >
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x42-376008x1">The Windows executables have different names from the Unix versions. The Windows client is called
     <span class="textit">boinc.exe</span>. Therefore, the configuration variable <span class="texttt">BOINC_Executable</span> <a 
 id="dx42-376009"></a><a 
 id="dx42-376010"></a> is written:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-737">
     <tspan font-family="ectt" font-size="0800">BOINC_Executable</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;C:\PROGRA~1\BOINC\boinc.exe</tspan>
</div>
     <!--l. 494--><p class="nopar" >
     <!--l. 497--><p class="noindent" >The Unix administrative tool <span class="textit">boinc_cmd</span> is called <span class="textit">boinccmd.exe</span> on Windows.
     </li>
     <li 
  class="enumerate" id="x42-376012x2">When using BOINC on Windows, the configuration variable <span class="texttt">BOINC_InitialDir</span> <a 
 id="dx42-376013"></a><a 
 id="dx42-376014"></a> will not be respected
     fully. To work around this difficulty, pass the BOINC home directory directly to the BOINC
     application via the <span class="texttt">BOINC_Arguments</span> <a 
 id="dx42-376015"></a><a 
 id="dx42-376016"></a> configuration variable. For Windows, rewrite the argument line
     as:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-738">
     <tspan font-family="ectt" font-size="0800">BOINC_Arguments</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;--dir</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$(BOINC_HOME)</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;--attach_project</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;http://einstein.phys.uwm.edu</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;[account_key]</tspan>
</div>
     <!--l. 513--><p class="nopar" >
     <!--l. 516--><p class="noindent" >As a consequence of setting the BOINC home directory, some projects may fail with the authentication
     error:
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-739">
     <tspan font-family="ectt" font-size="0800">Scheduler</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;request</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;failed:</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Peer</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">certificate</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;cannot</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;be</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;authenticated</tspan>
     <tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">with</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;known</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;CA</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;certificates.</tspan>
</div>
     <!--l. 523--><p class="nopar" >
     <!--l. 526--><p class="noindent" >To resolve this issue, copy the <span class="texttt">ca-bundle.crt</span> file from the BOINC installation directory to <span class="texttt">$(BOINC_HOME)</span>.
     This file appears to be project and machine independent, and it can therefore be distributed as part of an
     automated HTCondor installation.
     </li>
     <li 
  class="enumerate" id="x42-376018x3">The <span class="texttt">BOINC_Owner</span> <a 
 id="dx42-376019"></a><a 
 id="dx42-376020"></a> configuration variable behaves differently on Windows than it does on Unix. Its value may
     take one of two forms:
         <ul class="itemize1">
         <li class="itemize"><span class="obeylines-h"><span class="verb">domain\user</span></span>
         </li>
         <li class="itemize"><span class="obeylines-h"><span class="verb">user</span></span> This form assumes that the user exists in the local domain (that is, on the computer itself).</li></ul>
     <!--l. 546--><p class="noindent" >Setting this option causes the addition of the job attribute
                                                                                         

                                                                                         
     <div class="verbatim" id="verbatim-740">
     <tspan font-family="ectt" font-size="1000">RunAsUser</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
</div>
     <!--l. 549--><p class="nopar" > to the backfill client. This further implies that the configuration variable <span class="texttt">STARTER_ALLOW_RUNAS_OWNER</span> <a 
 id="dx42-376021"></a><a 
 id="dx42-376022"></a> be
     set to <span class="texttt">True</span> to insure that the local <span class="textit">condor_starter</span> be able to run jobs in this manner. For more information
     on the <span class="texttt">RunAsUser</span> attribute, see section&#x00A0;<a 
href="MicrosoftWindows.html#x76-5770008.2.4">8.2.4<!--tex4ht:ref: sec:windows-run-as-owner --></a>. For more information on the the <span class="texttt">STARTER_ALLOW_RUNAS_OWNER</span>
     configuration variable, see section&#x00A0;<a 
href="ConfigurationMacros.html#x33-1920003.5.5">3.5.5<!--tex4ht:ref: param:StarterAllowRunAsOwner --></a>.
     </li></ol>
<!--l. 2--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.11   </span> <a 
 id="x42-3770003.14.11"></a>Per Job PID Namespaces</h4>
<a 
 id="dx42-377001"></a>
<a 
 id="dx42-377002"></a>
<a 
 id="dx42-377003"></a>
<!--l. 8--><p class="noindent" >Per job PID namespaces provide enhanced isolation of one process tree from another through kernel level process ID
namespaces. HTCondor may enable the use of per job PID namespaces for Linux RHEL 6, Debian 6, and more
recent kernels.
<!--l. 13--><p class="indent" >   Read about per job PID namespaces <a 
href="http://lwn.net/Articles/531419/" >http://lwn.net/Articles/531419/</a>.
<!--l. 15--><p class="indent" >   The needed isolation of jobs from the same user that execute on the same machine as each other is already
provided by the implementation of slot users as described in section&#x00A0;<a 
href="Security.html#x36-2980003.8.13">3.8.13<!--tex4ht:ref: sec:RunAsNobody --></a>. This is the recommended way to
implement the prevention of interference between more than one job submitted by a single user. However,
the use of a shared file system by slot users presents issues in the ownership of files written by the
jobs.
<!--l. 23--><p class="indent" >   The per job PID namespace provides a way to handle the ownership of files produced by jobs within a shared file
system. It also isolates the processes of a job within its PID namespace. As a side effect and benefit, the clean up of
processes for a job within a PID namespace is enhanced. When the process with PID = 1 is killed, the operating
system takes care of killing all child processes.
<!--l. 31--><p class="indent" >   To enable the use of per job PID namespaces, set the configuration to include
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-741">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;USE_PID_NAMESPACES</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
</div>
<!--l. 36--><p class="nopar" >
<!--l. 38--><p class="indent" >   This configuration variable defaults to <span class="texttt">False</span>, thus the use of per job PID namespaces is disabled by
default.
   <h4 class="subsectionHead"><span class="titlemark">3.14.12   </span> <a 
 id="x42-3780003.14.12"></a>Group ID-Based Process Tracking</h4>
<!--l. 5--><p class="noindent" >One function that HTCondor often must perform is keeping track of all processes created by a job. This is done so
that HTCondor can provide resource usage statistics about jobs, and also so that HTCondor can properly clean up
any processes that jobs leave behind when they exit.
<!--l. 10--><p class="indent" >   In general, tracking process families is difficult to do reliably. By default HTCondor uses a combination of
process parent-child relationships, process groups, and information that HTCondor places in a job&#8217;s environment to
track process families on a best-effort basis. This usually works well, but it can falter for certain applications or for
jobs that try to evade detection.
<!--l. 17--><p class="indent" >   Jobs that run with a user account dedicated for HTCondor&#8217;s use can be reliably tracked, since all HTCondor
needs to do is look for all processes running using the given account. Administrators must specify in HTCondor&#8217;s
configuration what accounts can be considered dedicated via the <span class="texttt">DEDICATED_EXECUTE_ACCOUNT_REGEXP</span> <a 
 id="dx42-378001"></a><a 
 id="dx42-378002"></a> setting. See
Section&#x00A0;<a 
href="Security.html#x36-2980003.8.13">3.8.13<!--tex4ht:ref: sec:RunAsNobody --></a> for further details.
<!--l. 24--><p class="indent" >   Ideally, jobs can be reliably tracked regardless of the user account they execute under. This can be accomplished
with group ID-based tracking. This method of tracking requires that a range of dedicated <span class="emph">group</span> IDs (GID) be set
aside for HTCondor&#8217;s use. The number of GIDs that must be set aside for an execute machine is equal to its number
of execution slots. GID-based tracking is only available on Linux, and it requires that HTCondor daemons run as
root.
<!--l. 33--><p class="indent" >   GID-based tracking works by placing a dedicated GID in the supplementary group list of a job&#8217;s initial process.
Since modifying the supplementary group ID list requires root privilege, the job will not be able to create processes
that go unnoticed by HTCondor.
<!--l. 39--><p class="indent" >   Once a suitable GID range has been set aside for process tracking, GID-based tracking can be enabled via the
<span class="texttt">USE_GID_PROCESS_TRACKING</span> <a 
 id="dx42-378003"></a><a 
 id="dx42-378004"></a> parameter. The minimum and maximum GIDs included in the range are specified
with the <span class="texttt">MIN_TRACKING_GID</span> <a 
 id="dx42-378005"></a><a 
 id="dx42-378006"></a> and <span class="texttt">MAX_TRACKING_GID</span> <a 
 id="dx42-378007"></a><a 
 id="dx42-378008"></a> settings. For example, the following would enable GID-based
tracking for an execute machine with 8 slots.
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-742">
<tspan font-family="ectt" font-size="1000">USE_GID_PROCESS_TRACKING</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">MIN_TRACKING_GID</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;750</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">MAX_TRACKING_GID</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;757</tspan>
</div>
<!--l. 50--><p class="nopar" >
<!--l. 52--><p class="indent" >   If the defined range is too small, such that there is not a GID available when starting a job, then the
<span class="textit">condor_starter</span> will fail as it tries to start the job. An error message will be logged stating that there are no more
tracking GIDs.
<!--l. 57--><p class="indent" >   GID-based process tracking requires use of the <span class="textit">condor_procd</span>. If <span class="texttt">USE_GID_PROCESS_TRACKING</span> is true, the
<span class="textit">condor_procd</span> will be used regardless of the <span class="texttt">USE_PROCD</span> <a 
 id="dx42-378009"></a><a 
 id="dx42-378010"></a> setting. Changes to <span class="texttt">MIN_TRACKING_GID</span> and
<span class="texttt">MAX_TRACKING_GID</span> require a full restart of HTCondor.
<!--l. 64--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.13   </span> <a 
 id="x42-3790003.14.13"></a>Cgroup-Based Process Tracking</h4>
<a 
 id="dx42-379001"></a>
<!--l. 68--><p class="noindent" >A new feature in Linux version 2.6.24 allows HTCondor to more accurately and safely manage jobs composed of sets
of processes. This Linux feature is called Control Groups, or cgroups for short, and it is available starting with
RHEL 6, Debian 6, and related distributions. Documentation about Linux kernel support for cgroups can be
found in the Documentation directory in the kernel source code distribution. Another good reference is
<a 
href="http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/index.html" >http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Resource_Management_Guide/index.html</a>
Even if cgroup support is built into the kernel, many distributions do not install the cgroup tools by
default.
<!--l. 79--><p class="indent" >   The interface between the kernel cgroup functionality is via a (virtual) file system. When the condor_master
starts on a Linux system with cgroup support in the kernel, it checks to see if cgroups are mounted, and if not, it
will try to mount the cgroup virtual filesystem onto the directory /cgroup.
<!--l. 85--><p class="indent" >   If your Linux distribution uses <span class="textit">systemd</span>, it will mount the cgroup file system, and the only remaining item is to
set configuration variable <span class="texttt">BASE_CGROUP</span> <a 
 id="dx42-379002"></a><a 
 id="dx42-379003"></a>, as described below.
<!--l. 128--><p class="indent" >   On Debian based systems, the memory cgroup controller is often not on by default, and needs to be enabled with
a boot time option.
<!--l. 131--><p class="indent" >   This setting needs to be inherited down to the per-job cgroup with the following commands in
<span class="texttt">rc.local</span>:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-743">
<tspan font-family="ectt" font-size="1000">/usr/sbin/cgconfigparser</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-l</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/etc/cgconfig.conf</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">/bin/echo</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;1</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;&#x003E;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/sys/fs/cgroup/htcondor/cgroup.clone_children</tspan>
</div>
<!--l. 137--><p class="nopar" >
<!--l. 156--><p class="indent" >   When cgroups are correctly configured and running, the virtual file system mounted on <span class="texttt">/cgroup</span> should
have several subdirectories under it, and there should an <span class="texttt">htcondor</span> subdirectory under the directory
<span class="texttt">/cgroup/cpu</span>.
<!--l. 161--><p class="indent" >   The <span class="textit">condor_starter</span> daemon uses cgroups by default on Linux systems to accurately track all the processes
started by a job, even when quickly-exiting parent processes spawn many child processes. As with the GID-based
tracking, this is only implemented when a <span class="textit">condor_procd</span> daemon is running.
<!--l. 167--><p class="indent" >   Kernel cgroups are named in a virtual file system hierarchy. HTCondor will put each running job on
the execute node in a distinct cgroup. The name of this cgroup is the name of the execute directory
for that <span class="textit">condor_starter</span>, with slashes replaced by underscores, followed by the name and number of
the slot. So, for the memory controller, a job running on slot1 would have its cgroup located at
<span class="texttt">/cgroup/memory/htcondor/condor_var_lib_condor_execute_slot1/</span>. The <span class="texttt">tasks</span> file in this directory will
contain a list of all the processes in this cgroup, and many other files in this directory have useful information about
resource usage of this cgroup. See the kernel documentation for full details.
<!--l. 180--><p class="indent" >   Once cgroup-based tracking is configured, usage should be invisible to the user and administrator. The
<span class="textit">condor_procd</span> log, as defined by configuration variable <span class="texttt">PROCD_LOG</span>, will mention that it is using this
method, but no user visible changes should occur, other than the impossibility of a quickly-forking
process escaping from the control of the <span class="textit">condor_starter</span>, and the more accurate reporting of memory
usage.
   <h4 class="subsectionHead"><span class="titlemark">3.14.14   </span> <a 
 id="x42-3800003.14.14"></a>Limiting Resource Usage with a User Job Wrapper</h4>
<a 
 id="dx42-380001"></a>
<a 
 id="dx42-380002"></a>
<!--l. 7--><p class="noindent" >An administrator can strictly limit the usage of system resources by jobs for any job that may be wrapped using the
script defined by the configuration variable <span class="texttt">USER_JOB_WRAPPER</span> <a 
 id="dx42-380003"></a><a 
 id="dx42-380004"></a>. These are jobs within universes that are controlled
by the <span class="textit">condor_starter</span> daemon, and they include the <span class="textbf">vanilla</span>, <span class="textbf">standard</span>, <span class="textbf">java</span>, <span class="textbf">local</span>, and <span class="textbf">parallel</span>
universes.
<!--l. 16--><p class="indent" >   The job&#8217;s ClassAd is written by the <span class="textit">condor_starter</span> daemon. It will need to contain attributes that the script
defined by <span class="texttt">USER_JOB_WRAPPER</span> can use to implement platform specific resource limiting actions. Examples of
resources that may be referred to for limiting purposes are RAM, swap space, file descriptors, stack size, and core
file size.
                                                                                         

                                                                                         
<!--l. 23--><p class="indent" >   An initial sample of a <span class="texttt">USER_JOB_WRAPPER</span> script is provided in the installation at <span class="texttt">$(LIBEXEC)/condor_limits_wrapper.sh</span>.
Here is the contents of that file:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-744">
<tspan font-family="ectt" font-size="0800">#!/bin/bash</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Copyright</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;2008</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Red</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Hat,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Inc.</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Licensed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;under</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Apache</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;License,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Version</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;2.0</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;(the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"License");</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;you</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;may</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;not</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;use</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;this</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;file</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;except</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;in</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;compliance</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;with</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;License.</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;You</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;may</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;obtain</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;a</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;copy</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;of</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;License</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;at</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;http://www.apache.org/licenses/LICENSE-2.0</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Unless</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;required</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;by</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;applicable</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;law</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;or</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;agreed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;in</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;writing,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;software</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;distributed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;under</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;License</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;is</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;distributed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;on</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;an</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"AS</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;IS"</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;BASIS,</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;WITHOUT</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;WARRANTIES</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;OR</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;CONDITIONS</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;OF</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;ANY</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;KIND,</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;either</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;express</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;or</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;implied.</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;See</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;License</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;for</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;specific</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;language</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;governing</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;permissions</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;and</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">#</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;limitations</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;under</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;the</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;License.</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">if</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;[[</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$_CONDOR_MACHINE_AD</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;!=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;""</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;]];</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;then</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;mem_limit=$((</tspan><tspan font-family="tctt" font-size="0800">`</tspan><tspan font-family="ectt" font-size="0800">egrep</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">^Memory</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$_CONDOR_MACHINE_AD</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;|</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;cut</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-d</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;3</tspan><tspan font-family="tctt" font-size="0800">`</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;*</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;1024))</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;disk_limit=</tspan><tspan font-family="tctt" font-size="0800">`</tspan><tspan font-family="ectt" font-size="0800">egrep</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">^Disk</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$_CONDOR_MACHINE_AD</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;|</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;cut</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-d</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="tctt" font-size="0800">'</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;3</tspan><tspan font-family="tctt" font-size="0800">`</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;ulimit</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-d</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$mem_limit</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;if</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;[[</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$?</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;!=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;0</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;]]</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;||</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;[[</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$mem_limit</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;""</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;]];</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;then</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;echo</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"Failed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;set</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Memory</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Resource</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Limit"</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003E;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$_CONDOR_WRAPPER_ERROR_FILE</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;exit</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;1</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;fi</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;ulimit</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$disk_limit</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;if</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;[[</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$?</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;!=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;0</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;]]</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;||</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;[[</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$disk_limit</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;=</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;""</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;]];</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;then</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;echo</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"Failed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;set</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Disk</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Resource</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Limit"</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003E;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$_CONDOR_WRAPPER_ERROR_FILE</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;exit</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;1</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;fi</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">fi</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">exec</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"$@"</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">error=$?</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">echo</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"Failed</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;to</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;exec($error):</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$@"</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;&#x003E;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;$_CONDOR_WRAPPER_ERROR_FILE</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">exit</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;1</tspan>
</div>
<!--l. 65--><p class="nopar" >
<!--l. 68--><p class="indent" >   If used in an unmodified form, this script sets the job&#8217;s limits on a per slot basis for memory and disk usage,
with the limits defined by the values in the machine ClassAd. This example file will need to be modified and merged
for use with a preexisting <span class="texttt">USER_JOB_WRAPPER</span> script.
<!--l. 75--><p class="indent" >   If additional functionality is added to the script, an administrator is likely to use the <span class="texttt">USER_JOB_WRAPPER</span> script
in conjunction with <span class="texttt">SUBMIT_ATTRS</span> <a 
 id="dx42-380005"></a><a 
 id="dx42-380006"></a> or <span class="texttt">SUBMIT_EXPRS</span> <a 
 id="dx42-380007"></a><a 
 id="dx42-380008"></a> to force the job ClassAd to contain attributes that the
<span class="texttt">USER_JOB_WRAPPER</span> script expects to have defined.
<!--l. 81--><p class="indent" >   The following variables are set in the environment of the the <span class="texttt">USER_JOB_WRAPPER</span> script by the <span class="textit">condor_starter</span>
daemon, when the <span class="texttt">USER_JOB_WRAPPER</span> is defined.
     <dl class="description"><dt class="description">
                                                                                         

                                                                                         
<span class="texttt">_CONDOR_MACHINE_AD</span> <a 
 id="dx42-380009"></a> </dt><dd 
class="description">The full path and file name of the file containing the machine ClassAd.
     </dd><dt class="description">
<span class="texttt">_CONDOR_JOB_AD</span> <a 
 id="dx42-380010"></a> </dt><dd 
class="description">The full path and file name of the file containing the job ClassAd.
     </dd><dt class="description">
<span class="texttt">_CONDOR_WRAPPER_ERROR_FILE</span> <a 
 id="dx42-380011"></a> </dt><dd 
class="description">The full path and file name of the file that the <span class="texttt">USER_JOB_WRAPPER</span> script
     should create, if there is an error. The text in this file will be included in any HTCondor failure
     messages.</dd></dl>
<!--l. 2--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.15   </span> <a 
 id="x42-3810003.14.15"></a>Limiting Resource Usage Using Cgroups</h4>
<a 
 id="dx42-381001"></a>
<a 
 id="dx42-381002"></a>
<a 
 id="dx42-381003"></a>
<!--l. 8--><p class="noindent" >While the method described to limit a job&#8217;s resource usage is portable, and it should run on any Linux or
BSD or Unix system, it suffers from one large flaw. The flaw is that resource limits imposed are per
process, not per job. An HTCondor job is often composed of many Unix processes. If the method of
limiting resource usage with a user job wrapper is used to impose a 2 Gigabyte memory limit, that
limit applies to each process in the job individually. If a job created 100 processes, each using just
under 2 Gigabytes, the job would continue without the resource limits kicking in. Clearly, this is not
what the machine owner intends. Moreover, the memory limit only applies to the virtual memory
size, not the physical memory size, or the resident set size. This can be a problem for jobs that use
the <span class="texttt">mmap</span> system call to map in a large chunk of virtual memory, but only need a small amount of
memory at one time. Typically, the resource the administrator would like to control is physical memory,
because when that is in short supply, the machine starts paging, and can become unresponsive very
quickly.
<!--l. 30--><p class="indent" >   The <span class="textit">condor_starter</span> can, using the Linux cgroup capability, apply resource limits collectively to sets of jobs, and
apply limits to the physical memory used by a set of processes. The main downside of this technique is that it is
only available on relatively new Unix distributions such as RHEL 6 and Debian 6. This technique also may require
editing of system configuration files.
<!--l. 37--><p class="indent" >   To enable cgroup-based limits, first ensure that cgroup-based tracking is enabled, as it is by default on
supported systems, as described in section &#x00A0;<a 
href="#x42-3790003.14.13">3.14.13<!--tex4ht:ref: sec:CGroupTracking --></a>. Once set, the <span class="textit">condor_starter</span> will create a cgroup
for each job, and set two attributes in that cgroup which control resource usage therein. These two
attributes are the cpu.shares attribute in the cpu controller, and one of two attributes in the memory
controller, either memory.limit_in_bytes, or memory.soft_limit_in_bytes. The configuration variable
<span class="texttt">CGROUP_MEMORY_LIMIT_POLICY</span> <a 
 id="dx42-381004"></a><a 
 id="dx42-381005"></a> controls whether the hard limit (the former) or the soft limit will be
used. If <span class="texttt">CGROUP_MEMORY_LIMIT_POLICY</span> is set to the string <span class="texttt">hard</span>, the hard limit will be used. If set to
<span class="texttt">soft</span>, the soft limit will be used. Otherwise, no limit will be set if the value is <span class="texttt">none</span>. The default is
<span class="texttt">none</span>. If the hard limit is in force, then the total amount of physical memory used by the sum of all
processes in this job will not be allowed to exceed the limit. If the processes try to allocate more memory,
the allocation will succeed, and virtual memory will be allocated, but no additional physical memory
                                                                                         

                                                                                         
will be allocated. The system will keep the amount of physical memory constant by swapping some
page from that job out of memory. However, if the soft limit is in place, the job will be allowed to go
over the limit if there is free memory available on the system. Only when there is contention between
other processes for physical memory will the system force physical memory into swap and push the
physical memory used towards the assigned limit. The memory size used in both cases is the machine
ClassAd attribute <span class="texttt">Memory</span>. Note that <span class="texttt">Memory</span> is a static amount when using static slots, but it is dynamic
when partitionable slots are used. That is, the limit is whatever the "Mem" column of condor_status
reports for that slot. If the job exceeds both the physical memory and swap space, the job will be
killed by the Linux Out-of-Memory killer, and HTCondor will put the job on hold with an appropriate
message.
<!--l. 76--><p class="indent" >   If <span class="texttt">CGROUP_MEMORY_LIMIT_POLICY</span> is set, HTCondor will also also use cgroups to limit the amount of swap space
used by each job. By default, the maximum amount of swap space used by each slot is the total amount of
Virtual Memory in the slot, minus the amount of physical memory. Note that HTCondor measures
virtual memory in kbytes, and physical memory in megabytes. To prevent jobs with high memory usage
from thrashing and excessive paging, and force HTCondor to put them on hold instead, you can set
a lower limit on the amount of swap space they are allowed to use. With partitionable slots, this is
done in the per slot definition, and must be a percentage of the total swap space on the system. For
example,
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-745">
<tspan font-family="ectt" font-size="1000">NUM_SLOTS_TYPE_1</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;1</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SLOT_TYPE_1_PARTITIONABLE</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;true</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SLOT_TYPE_1</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;cpus=100%,swap=10%</tspan>
</div>
<!--l. 92--><p class="nopar" >
<!--l. 94--><p class="indent" >   Optionally, if the administrator sets the config file setting <span class="texttt">PROPORTIONAL_SWAP_ASSSIGNMENT</span> <a 
 id="dx42-381006"></a><a 
 id="dx42-381007"></a> = true, the
maximum amount of swap space per slot will be set to the same proportion of the total swap as as the proportion of
physical memory. That is, if a slot (static or dyanmic) has half of the physical memory of the machine, it will be
given half of the swap space.
<!--l. 101--><p class="indent" >   In addition to memory, the <span class="textit">condor_starter</span> can also control the total amount of CPU used by all processes
within a job. To do this, it writes a value to the cpu.shares attribute of the cgroup cpu controller. The value it writes
is copied from the <span class="texttt">Cpus</span> attribute of the machine slot ClassAd multiplied by 100. Again, like the <span class="texttt">Memory</span>
attribute, this value is fixed for static slots, but dynamic under partitionable slots. This tells the operating
system to assign cpu usage proportionally to the number of cpus in the slot. Unlike memory, there is no
concept of <span class="texttt">soft</span> or <span class="texttt">hard</span>, so this limit only applies when there is contention for the cpu. That is, on an
eight core machine, with only a single, one-core slot running, and otherwise idle, the job running in
the one slot could consume all eight cpus concurrently with this limit in play, if it is the only thing
running. If, however, all eight slots where running jobs, with each configured for one cpu, the cpu
usage would be assigned equally to each job, regardless of the number of processes or threads in each
job.
<!--l. 2--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">3.14.16   </span> <a 
 id="x42-3820003.14.16"></a>Concurrency Limits</h4>
<a 
 id="dx42-382001"></a>
<!--l. 6--><p class="noindent" ><span class="emph">Concurrency limits</span> allow an administrator to limit the number of concurrently running jobs that declare that they
use some pool-wide resource. This limit is applied globally to all jobs submitted from all schedulers across one
HTCondor pool; the limits are <span class="emph">not</span> applied to scheduler, local, or grid universe jobs. This is useful in the case of a
shared resource, such as an NFS or database server that some jobs use, where the administrator needs to limit the
number of jobs accessing the server.
<!--l. 17--><p class="indent" >   The administrator must predefine the names and capacities of the resources to be limited in the negotiator&#8217;s
configuration file. The job submitter must declare in the submit description file which resources the job
consumes.
<!--l. 22--><p class="indent" >   The administrator chooses a name for the limit. Concurrency limit names are case-insensitive. The
names are formed from the alphabet letters &#8217;A&#8217; to &#8217;Z&#8217; and &#8217;a&#8217; to &#8217;z&#8217;, the numerical digits 0 to 9, the
underscore character &#8217;_&#8217; , and at most one period character. The names cannot start with a numerical
                                                                                         

                                                                                         
digit.
<!--l. 29--><p class="indent" >   For example, assume that there are 3 licenses for the X software, so HTCondor should constrain the number of
running jobs which need the X software to 3. The administrator picks XSW as the name of the resource and sets the
configuration
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-746">
<tspan font-family="ectt" font-size="1000">XSW_LIMIT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;3</tspan>
</div>
<!--l. 36--><p class="nopar" > where <span class="texttt">XSW</span> is the invented name of this resource, and this name is appended with the string <span class="texttt">_LIMIT</span>. With this limit,
a maximum of 3 jobs declaring that they need this resource may be executed concurrently.
<!--l. 42--><p class="indent" >   In addition to named limits, such as in the example named limit <span class="texttt">XSW</span>, configuration may specify a concurrency
limit for all resources that are not covered by specifically-named limits. The configuration variable
<span class="texttt">CONCURRENCY_LIMIT_DEFAULT</span> <a 
 id="dx42-382002"></a><a 
 id="dx42-382003"></a> sets this value. For example,
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-747">
<tspan font-family="ectt" font-size="1000">CONCURRENCY_LIMIT_DEFAULT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;1</tspan>
</div>
<!--l. 49--><p class="nopar" > will enforce a limit of at most 1 running job that declares a usage of an unnamed resource. If
<span class="texttt">CONCURRENCY_LIMIT_DEFAULT</span> is omitted from the configuration, then no limits are placed on the number of
concurrently executing jobs for which there is no specifically-named concurrency limit.
<!--l. 57--><p class="indent" >   The job must declare its need for a resource by placing a command in its submit description file or adding an
attribute to the job ClassAd. In the submit description file, an example job that requires the X software
adds:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-748">
<tspan font-family="ectt" font-size="1000">concurrency_limits</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;XSW</tspan>
</div>
<!--l. 64--><p class="nopar" > This results in the job ClassAd attribute
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-749">
<tspan font-family="ectt" font-size="1000">ConcurrencyLimits</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"XSW"</tspan>
</div>
<!--l. 68--><p class="nopar" >
<!--l. 70--><p class="indent" >   Jobs may declare that they need more than one type of resource. In this case, specify a comma-separated list of
resources:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-750">
<tspan font-family="ectt" font-size="1000">concurrency_limits</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;XSW,</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;DATABASE,</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;FILESERVER</tspan>
</div>
<!--l. 75--><p class="nopar" >
<!--l. 77--><p class="indent" >   The units of these limits are arbitrary. This job consumes one unit of each resource. Jobs can declare that they
use more than one unit with syntax that follows the resource name by a colon character and the integer number
of resources. For example, if the above job uses three units of the file server resource, it is declared
with
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-751">
<tspan font-family="ectt" font-size="1000">concurrency_limits</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;XSW,</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;DATABASE,</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;FILESERVER:3</tspan>
</div>
<!--l. 87--><p class="nopar" >
<!--l. 89--><p class="indent" >   If there are sets of resources which have the same capacity for each member of the set, the configuration may
become tedious, as it defines each member of the set individually. A shortcut defines a name for a set. For example,
define the sets called <span class="texttt">LARGE</span> and <span class="texttt">SMALL</span>:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-752">
<tspan font-family="ectt" font-size="1000">CONCURRENCY_LIMIT_DEFAULT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;5</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">CONCURRENCY_LIMIT_DEFAULT_LARGE</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;100</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">CONCURRENCY_LIMIT_DEFAULT_SMALL</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;25</tspan>
</div>
<!--l. 100--><p class="nopar" >
<!--l. 102--><p class="indent" >   To use the set name in a concurrency limit, the syntax follows the set name with a period and then the set
member&#8217;s name. Continuing this example, there may be a concurrency limit named <span class="texttt">LARGE.SWLICENSE</span>, which gets
the capacity of the default defined for the <span class="texttt">LARGE</span> set, which is 100. A concurrency limit named <span class="texttt">LARGE.DBSESSION</span>
will also have a limit of 100. A concurrency limit named <span class="texttt">OTHER.LICENSE</span> will receive the default limit of 5, as there
is no set named <span class="texttt">OTHER</span>.
<!--l. 115--><p class="indent" >   A concurrency limit may be evaluated against the attributes of a matched machine. This allows a job to vary
what concurrency limits it requires based on the machine to which it is matched. To implement this, the job uses
submit command <span class="textbf">concurrency_limits_expr</span><a 
 id="dx42-382004"></a> instead of <span class="textbf">concurrency_limits</span><a 
 id="dx42-382005"></a>. Consider an example in which
execute machines are located on one of two local networks. The administrator sets a concurrency limit to limit the
number of network intensive jobs on each network to 10. Configuration of each execute machine advertises which
local network it is on. A machine on <span class="texttt">"NETWORK_A"</span> configures
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-753">
<tspan font-family="ectt" font-size="1000">NETWORK</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"NETWORK_A"</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">STARTD_ATTRS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(STARTD_ATTRS)</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;NETWORK</tspan>
</div>
<!--l. 132--><p class="nopar" > and a machine on <span class="texttt">"NETWORK_B"</span> configures
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-754">
<tspan font-family="ectt" font-size="1000">NETWORK</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"NETWORK_B"</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">STARTD_ATTRS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;$(STARTD_ATTRS)</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;NETWORK</tspan>
</div>
<!--l. 137--><p class="nopar" >
<!--l. 139--><p class="indent" >   The configuration for the negotiator sets the concurrency limits:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-755">
<tspan font-family="ectt" font-size="1000">NETWORK_A_LIMIT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;10</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">NETWORK_B_LIMIT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;10</tspan>
</div>
<!--l. 143--><p class="nopar" >
<!--l. 145--><p class="indent" >   Each network intensive job identifies itself by specifying the limit within the submit description
file:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-756">
<tspan font-family="ectt" font-size="1000">concurrency_limits_expr</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;TARGET.NETWORK</tspan>
</div>
<!--l. 149--><p class="nopar" >
<!--l. 151--><p class="indent" >   The concurrency limit is applied based on the network of the matched machine.
<!--l. 154--><p class="indent" >   An extension of this example applies two concurrency limits. One limit is the same as in the example, such that
it is based on an attribute of the matched machine. The other limit is of a specialized application called <span class="texttt">"SWX"</span> in
this example. The negotiator configuration is extended to also include
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-757">
<tspan font-family="ectt" font-size="1000">SWX_LIMIT</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;15</tspan>
</div>
<!--l. 162--><p class="nopar" >
<!--l. 164--><p class="indent" >   The network intensive job that also uses two units of the <span class="texttt">SWX</span> application identifies the needed resources in the
single submit command:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-758">
<tspan font-family="ectt" font-size="1000">concurrency_limits_expr</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;strcat("SWX:2</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;",</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;TARGET.NETWORK)</tspan>
</div>
<!--l. 168--><p class="nopar" >
<!--l. 170--><p class="indent" >   Submit command <span class="textbf">concurrency_limits_expr</span> may not be used together with submit command
<span class="textbf">concurrency_limits</span>.
<!--l. 173--><p class="indent" >   Note that it is possible, under unusual circumstances, for more jobs to be started than should be
allowed by the concurrency limits feature. In the presence of preemption and dropped updates from the
<span class="textit">condor_startd</span> daemon to the <span class="textit">condor_collector</span> daemon, it is possible for the limit to be exceeded. If the
limits are exceeded, HTCondor will not kill any job to reduce the number of running jobs to meet the
limit.
                                                                                         

                                                                                         
<!--l. 2--><p class="indent" >   <span style="font-size: 200%;"><a 
href="TheHighAvailabilityofDaemons.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="TheHighAvailabilityofDaemons.html#tailTheHighAvailabilityofDaemons.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="SettingUpforSpecialEnvironments.html" >&#x2191;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="AdministratorsManual.html#SettingUpforSpecialEnvironments.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="JavaSupportInstallation.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><a 
 id="tailSettingUpforSpecialEnvironments.html"></a>  
</body></html> 
