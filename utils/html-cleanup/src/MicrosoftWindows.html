<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Microsoft Windows</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- 3,sec-filename,next,info,NoFonts,fonts,html --> 
<meta name="src" content="ref.tex"> 
<link rel="stylesheet" type="text/css" href="ref.css"> 
</head><body 
>
   <span style="font-size: 200%;"><a 
href="Linux.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Linux.html#tailLinux.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="#tailMicrosoftWindows.html">&#x2193;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="PlatformSpecificInformation.html#MicrosoftWindows.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="MacintoshOSX.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><h3 class="sectionHead"><span class="titlemark">8.2   </span> <a 
 id="x76-5730008.2"></a>Microsoft Windows</h3>
   <div class="sectionTOCS">
   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.1 <a 
href="#x76-5740008.2.1">Limitations under Windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.2 <a 
href="#x76-5750008.2.2">Supported Features under Windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.3 <a 
href="#x76-5760008.2.3">Secure Password Storage</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.4 <a 
href="#x76-5770008.2.4">Executing Jobs as the Submitting User</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.5 <a 
href="#x76-5780008.2.5">The condor_credd Daemon</a></span>
<br />   &#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" ><a 
href="#x76-5790008.2.5" id="QQ2-76-602">Using a pool password on Windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.6 <a 
href="#x76-5800008.2.6">Executing Jobs with the User&#8217;s Profile Loaded</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.7 <a 
href="#x76-5810008.2.7">Using Windows Scripts as Job Executables</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.8 <a 
href="#x76-5820008.2.8">How HTCondor for Windows Starts and Stops a Job</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.9 <a 
href="#x76-5830008.2.9">Security Considerations in HTCondor for Windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.10 <a 
href="#x76-5840008.2.10">Network files and HTCondor</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.11 <a 
href="#x76-5850008.2.11">Interoperability between HTCondor for Unix and HTCondor for Windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >8.2.12 <a 
href="#x76-5860008.2.12">Some differences between HTCondor for Unix -vs- HTCondor for Windows</a></span>
   </div>
<a 
 id="dx76-573001"></a>
<!--l. 6--><p class="indent" >   Windows is a strategic platform for HTCondor, and therefore we have been working toward a complete port to
Windows. Our goal is to make HTCondor every bit as capable on Windows as it is on Unix &#8211; or even more
capable.
<!--l. 12--><p class="indent" >   Porting HTCondor from Unix to Windows is a formidable task, because many components of HTCondor must
interact closely with the underlying operating system. Provided is a clipped version of HTCondor for
Windows. A clipped version is one in which there is no checkpointing and there are no remote system
calls.
<!--l. 20--><p class="indent" >   This section contains additional information specific to running HTCondor on Windows. In order to effectively
                                                                                         

                                                                                         
use HTCondor, first read the overview chapter (section&#x00A0;<a 
href="HighThroughputComputingHTCanditsRequirements.html#x4-40001.1">1.1<!--tex4ht:ref: sec:overview --></a>) and the user&#8217;s manual (section&#x00A0;<a 
href="WelcometoHTCondor.html#x13-130002.1">2.1<!--tex4ht:ref: sec:usermanual --></a>). If administrating
or customizing the policy and set up of HTCondor, also read the administrator&#8217;s manual chapter (section&#x00A0;<a 
href="Introduction1.html#x29-1480003.1">3.1<!--tex4ht:ref: sec:Admin-Intro --></a>). After
reading these chapters, review the information in this chapter for important information and differences when using
and administrating HTCondor on Windows. For information on installing HTCondor for Windows, see
section&#x00A0;<a 
href="InstallationStartUpShutDownandReconfiguration.html#x30-1580003.2.3">3.2.3<!--tex4ht:ref: sec:Windows-Install --></a>.
<!--l. 38--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.1   </span> <a 
 id="x76-5740008.2.1"></a>Limitations under Windows</h4>
<a 
 id="dx76-574001"></a>
<!--l. 42--><p class="noindent" >In general, this release for Windows works the same as the release of HTCondor for Unix. However, the following
items are not supported in this version:
     <ul class="itemize1">
     <li class="itemize">The standard job universe is not present. This means transparent process checkpoint/migration and
     remote system calls are not supported.
     </li>
     <li class="itemize"><span class="textbf">grid</span> universe jobs may not be submitted from a Windows platform, unless the grid type is <span class="textbf">condor</span>.
     </li>
     <li class="itemize">Accessing files via a network share that requires a Kerberos ticket (such as AFS) is not yet supported.
     </li></ul>
<!--l. 61--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.2   </span> <a 
 id="x76-5750008.2.2"></a>Supported Features under Windows</h4>
<!--l. 64--><p class="noindent" >Except for those items listed above, most everything works the same way in HTCondor as it does
in the Unix release. This release is based on the HTCondor Version 8.9.1&#x00A0;source tree, and thus the
feature set is the same as HTCondor Version 8.9.1&#x00A0;for Unix. For instance, all of the following work in
HTCondor:
     <ul class="itemize1">
     <li class="itemize">The ability to submit, run, and manage queues of jobs running on a cluster of Windows machines.
     </li>
     <li class="itemize">All tools such as <span class="textit">condor_q</span>, <span class="textit">condor_status</span>, <span class="textit">condor_userprio</span>, are included. Only <span class="textit">condor_compile</span> is
     <span class="emph">not</span> included.
                                                                                         

                                                                                         
     </li>
     <li class="itemize">The ability to customize job policy using ClassAds. The machine ClassAds contain all the information
     included in the Unix version, including current load average, RAM and virtual memory sizes, integer
     and floating-point performance, keyboard/mouse idle time, etc. Likewise, job ClassAds contain a full
     complement of information, including system dependent entries such as dynamic updates of the job&#8217;s
     image size and CPU usage.
     </li>
     <li class="itemize">Everything necessary to run an HTCondor central manager on Windows.
     </li>
     <li class="itemize">Security mechanisms.
     </li>
     <li class="itemize">HTCondor  for  Windows  can  run  jobs  at  a  lower  operating  system  priority  level.  Jobs  can  be
     suspended, soft-killed by using a WM_CLOSE message, or hard-killed automatically based upon policy
     expressions. For example, HTCondor can automatically suspend a job whenever keyboard/mouse or
     non-HTCondor created CPU activity is detected, and continue the job after the machine has been idle
     for a specified amount of time.
     </li>
     <li class="itemize">HTCondor correctly manages jobs which create multiple processes. For instance, if an HTCondor job
     spawns multiple processes and HTCondor needs to kill the job, all processes created by the job will be
     terminated.
     </li>
     <li class="itemize">In addition to interactive tools, users and administrators can receive information from HTCondor by
     e-mail (standard SMTP) and/or by log files.
     </li>
     <li class="itemize">HTCondor includes a friendly GUI installation and set up program, which can perform a full install or
     deinstall of HTCondor. Information specified by the user in the set up program is stored in the system
     registry. The set up program can update a current installation with a new release using a minimal
     amount of effort.
     </li>
     <li class="itemize">HTCondor can give a job access to the running user&#8217;s Registry hive.
     </li></ul>
<!--l. 119--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.3   </span> <a 
 id="x76-5760008.2.3"></a>Secure Password Storage</h4>
<!--l. 122--><p class="noindent" >In order for HTCondor to operate properly, it must at times be able to act on behalf of users who submit jobs. This
is required on submit machines, so that HTCondor can access a job&#8217;s input files, create and access the job&#8217;s output
files, and write to the job&#8217;s log file from within the appropriate security context. On Unix systems, arbitrarily
                                                                                         

                                                                                         
changing what user HTCondor performs its actions as is easily done when HTCondor is started with root privileges.
On Windows, however, performing an action as a particular user or on behalf of a particular user requires knowledge
of that user&#8217;s password, even when running at the maximum privilege level. HTCondor provides secure
password storage through the use of the <span class="textit">condor_store_cred</span> tool. Passwords managed by HTCondor are
encrypted and stored in a secure location within the Windows registry. When HTCondor needs to
perform an action as or on behalf of a particular user, it uses the securely stored password to do so.
This implies that a password is stored for every user that will submit jobs from the Windows submit
machine.
<a 
 id="dx76-576001"></a>
<a 
 id="dx76-576002"></a>
<a 
 id="dx76-576003"></a>
<a 
 id="dx76-576004"></a>
<!--l. 146--><p class="indent" >   A further feature permits HTCondor to execute the job itself under the security context of its submitting user,
specifying the <span class="textbf">run_as_owner</span><a 
 id="dx76-576005"></a> command in the job&#8217;s submit description file. With this feature, it is necessary to
configure and run a centralized <span class="textit">condor_credd</span> daemon to manage the secure password storage. This makes each
user&#8217;s password available, via an encrypted connection to the <span class="textit">condor_credd</span>, to any execute machine that may need
it.
<!--l. 156--><p class="indent" >   By default, the secure password store for a submit machine when no <span class="textit">condor_credd</span> is running is managed by the
<span class="textit">condor_schedd</span>. This approach works in environments where the user&#8217;s password is only needed on the submit
machine.
<!--l. 162--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.4   </span> <a 
 id="x76-5770008.2.4"></a>Executing Jobs as the Submitting User</h4>
<a 
 id="dx76-577001"></a>
<!--l. 166--><p class="noindent" >By default, HTCondor executes jobs on Windows using dedicated run accounts that have minimal access
rights and privileges, and which are recreated for each new job. As an alternative, HTCondor can be
configured to allow users to run jobs using their Windows login accounts. This may be useful if jobs need
access to files on a network share, or to other resources that are not available to the low-privilege run
account.
<!--l. 174--><p class="indent" >   This feature requires use of a <span class="textit">condor_credd</span> daemon for secure password storage and retrieval. With the
<span class="textit">condor_credd</span> daemon running, the user&#8217;s password must be stored, using the <span class="textit">condor_store_cred</span> tool.
Then, a user that wants a job to run using their own account places into the job&#8217;s submit description
file
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-962">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;run_as_owner</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
</div>
<!--l. 183--><p class="nopar" >
<!--l. 186--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.5   </span> <a 
 id="x76-5780008.2.5"></a>The condor_credd Daemon</h4>
<a 
 id="dx76-578001"></a>
<a 
 id="dx76-578002"></a>
<a 
 id="dx76-578003"></a>
<!--l. 191--><p class="noindent" >The <span class="textit">condor_credd</span> daemon manages secure password storage. A single running instance of the <span class="textit">condor_credd</span> within
an HTCondor pool is necessary in order to provide the feature described in section <a 
href="#x76-5770008.2.4">8.2.4<!--tex4ht:ref: sec:windows-run-as-owner --></a>, where a job runs as the
submitting user, instead of as a temporary user that has strictly limited access capabilities.
<!--l. 198--><p class="indent" >   It is first necessary to select the single machine on which to run the <span class="textit">condor_credd</span>. Often, the machine acting as
the pool&#8217;s central manager is a good choice. An important restriction, however, is that the <span class="textit">condor_credd</span> host must
be a machine running Windows.
<!--l. 204--><p class="indent" >   All configuration settings necessary to enable the <span class="textit">condor_credd</span> are contained in the example file
<span class="obeylines-h"><span class="verb">etc\condor_config.local.credd</span></span> from the HTCondor distribution. Copy these settings into a local configuration
file for the machine that will run the <span class="textit">condor_credd</span>. Run <span class="texttt">condor_restart</span> for these new settings to take effect, then
verify (via Task Manager) that a <span class="textit">condor_credd</span> process is running.
<!--l. 211--><p class="indent" >   A second set of configuration variables specify security for the communication among HTCondor daemons. These
variables must be set for all machines in the pool. The following example settings are in the comments contained in
the <span class="obeylines-h"><span class="verb">etc\condor_config.local.credd</span></span> example file. These sample settings rely on the <span class="texttt">PASSWORD</span> method for
authentication among daemons, including communication with the <span class="textit">condor_credd</span> daemon. The <span class="texttt">LOCAL_CREDD</span> <a 
 id="dx76-578004"></a><a 
 id="dx76-578005"></a>
variable must be customized to point to the machine hosting the <span class="textit">condor_credd</span> and the <span class="texttt">ALLOW_CONFIG</span> <a 
 id="dx76-578006"></a><a 
 id="dx76-578007"></a>
variable will be customized, if needed, to refer to an administrative account that exists on all HTCondor
nodes.
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-963">
<tspan font-family="ectt" font-size="1000">CREDD_HOST</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;credd.cs.wisc.edu</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">CREDD_CACHE_LOCALLY</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">STARTER_ALLOW_RUNAS_OWNER</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br />
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">ALLOW_CONFIG</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Administrator@*</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SEC_CLIENT_AUTHENTICATION_METHODS</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;NTSSPI,</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;PASSWORD</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SEC_CONFIG_NEGOTIATION</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;REQUIRED</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SEC_CONFIG_AUTHENTICATION</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;REQUIRED</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SEC_CONFIG_ENCRYPTION</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;REQUIRED</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">SEC_CONFIG_INTEGRITY</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;REQUIRED</tspan>
</div>
<!--l. 235--><p class="nopar" >
<!--l. 237--><p class="indent" >   The example above can be modified to meet the needs of your pool, providing the following conditions are
met:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x76-578009x1">The requesting client must use an authenticated connection
     </li>
     <li 
  class="enumerate" id="x76-578011x2">The requesting client must have an encrypted connection
     </li>
     <li 
  class="enumerate" id="x76-578013x3">The requesting client must be authorized for <span class="texttt">DAEMON</span> level access.</li></ol>
<!--l. 246--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x76-5790008.2.5"></a>Using a pool password on Windows</h5>
<!--l. 249--><p class="noindent" >In order for <span class="texttt">PASSWORD</span> authenticated communication to work, a <span class="emph">pool password</span> must be chosen and distributed. The
chosen pool password must be stored identically for each machine. The pool password first should be stored on the
<span class="textit">condor_credd</span> host, then on the other machines in the pool.
<!--l. 255--><p class="indent" >   To store the pool password on a Windows machine, run
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-964">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_store_cred</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;add</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-c</tspan>
</div>
<!--l. 258--><p class="nopar" > when logged in with the administrative account on that machine, and enter the password when prompted. If the
administrative account is shared across all machines, that is if it is a domain account or has the same
password on all machines, logging in separately to each machine in the pool can be avoided. Instead,
the pool password can be securely pushed out for each Windows machine using a command of the
form
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-965">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_store_cred</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;add</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-c</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-n</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;exec01.cs.wisc.edu</tspan>
</div>
<!--l. 268--><p class="nopar" >
<!--l. 270--><p class="indent" >   Once the pool password is distributed, but before submitting jobs, all machines must reevaluate their
configuration, so execute
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-966">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_reconfig</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-all</tspan>
</div>
<!--l. 276--><p class="nopar" > from the central manager. This will cause each execute machine to test its ability to authenticate with the
<span class="textit">condor_credd</span>. To see whether this test worked for each machine in the pool, run the command
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-967">
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;condor_status</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"%s\t"</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;Name</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;-f</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;"%s\n"</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;ifThenElse(isUndefined(LocalCredd),\"UNDEF\",LocalCredd)</tspan>
</div>
<!--l. 284--><p class="nopar" > Any rows in the output with the <span class="texttt">UNDEF</span> string indicate machines where secure communication is not working
properly. Verify that the pool password is stored correctly on these machines.
<!--l. 290--><p class="indent" >   Regardless of how Condor&#8217;s authentication is configured, the pool password can always be set locally by running
the
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-968">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_store_cred</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;add</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-c</tspan>
</div>
<!--l. 294--><p class="nopar" > command as the local SYSTEM account. Third party tools such as PsExec can be used to accomplish this. When
condor_store_cred is run as the local SYSTEM account, it bypasses the network authentication and writes the pool
password to the registry itself. This allows the other condor daemons (also running under the SYSTEM account) to
access the pool password when authenticating against the pool&#8217;s collector. In case the pool is remote and no initial
communication can be established due to strong security, the pool password may have to be set using the above
method and following command:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-969">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_store_cred</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-u</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_pool@poolhost</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;add</tspan>
</div>
<!--l. 306--><p class="nopar" >
<!--l. 309--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.6   </span> <a 
 id="x76-5800008.2.6"></a>Executing Jobs with the User&#8217;s Profile Loaded</h4>
<a 
 id="dx76-580001"></a>
<!--l. 312--><p class="noindent" >HTCondor can be configured when using dedicated run accounts, to load the account&#8217;s profile. A user&#8217;s profile
includes a set of personal directories and a registry hive loaded under <span class="texttt">HKEY_CURRENT_USER</span>.
<!--l. 316--><p class="indent" >   This may be useful if the job requires direct access to the user&#8217;s registry entries. It also may be useful when the
job requires an application, and the application requires registry access. This feature is always enabled on the
<span class="textit">condor_startd</span>, but it is limited to the dedicated run account. For security reasons, the profile is cleaned before a
subsequent job which uses the dedicated run account begins. This ensures that malicious jobs cannot discover what
any previous job has done, nor sabotage the registry for future jobs. It also ensures the next job has a fresh registry
hive.
<!--l. 329--><p class="indent" >   A job that is to run with a profile uses the <span class="textbf">load_profile</span><a 
 id="dx76-580002"></a> command in the job&#8217;s submit description
file:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-970">
<tspan font-family="ectt" font-size="1000">load_profile</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
</div>
<!--l. 333--><p class="nopar" >
<!--l. 335--><p class="indent" >   This feature is currently not compatible with <span class="textbf">run_as_owner</span><a 
 id="dx76-580003"></a>, and will be ignored if both are
specified.
<!--l. 339--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.7   </span> <a 
 id="x76-5810008.2.7"></a>Using Windows Scripts as Job Executables</h4>
<!--l. 342--><p class="noindent" >HTCondor has added support for scripting jobs on Windows. Previously, HTCondor jobs on Windows were limited
to executables or batch files. With this new support, HTCondor determines how to interpret the script using the file
name&#8217;s extension. Without a file name extension, the file will be treated as it has been in the past: as a Windows
executable.
<!--l. 351--><p class="indent" >   This feature may not require any modifications to HTCondor&#8217;s configuration. An example that does not require
administrative intervention are Perl scripts using <span class="textit">ActivePerl</span>.
<!--l. 355--><p class="indent" >   <span class="textit">Windows Scripting Host</span> scripts do require configuration to work correctly. The configuration variables set values
to be used in registry look up, which results in a command that invokes the correct interpreter, with the correct
command line arguments for the specific scripting language. In Microsoft nomenclature, <span class="emph">verbs</span> are actions that can
be taken upon a given a file. The familiar examples of <span class="textbf">Open</span>, <span class="textbf">Print</span>, and <span class="textbf">Edit</span>, can be found on the
context menu when a user right clicks on a file. The command lines to be used for each of these verbs
are stored in the registry under the <span class="texttt">HKEY_CLASSES_ROOT</span> hive. In general, a registry look up uses the
form:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-971">
<tspan font-family="ectt" font-size="0800">HKEY_CLASSES_ROOT\&#x003C;FileType&#x003E;\Shell\&#x003C;OpenVerb&#x003E;\Command</tspan>
</div>
<!--l. 373--><p class="nopar" >
<!--l. 376--><p class="indent" >   Within this specification, <span class="obeylines-h"><span class="verb">&#x003C;FileType&#x003E;</span></span> is the name of a file type (and therefore a scripting language), and is
obtained from the file name extension. <span class="obeylines-h"><span class="verb">&#x003C;OpenVerb&#x003E;</span></span> identifies the verb, and is obtained from the HTCondor
configuration.
<!--l. 383--><p class="indent" >   The HTCondor configuration sets the selection of a verb, to aid in the registry look up. The file
name extension sets the name of the HTCondor configuration variable. This variable name is of the
form:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-972">
<tspan font-family="ectt" font-size="1000">OPEN_VERB_FOR_&#x003C;EXT&#x003E;_FILES</tspan>
</div>
<!--l. 389--><p class="nopar" > <span class="obeylines-h"><span class="verb">&#x003C;EXT&#x003E;</span></span> represents the file name extension. The following configuration example uses the <span class="obeylines-h"><span class="verb">Open2</span></span> verb for a <span class="textit">Windows
Scripting Host</span> registry look up for several scripting languages:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-973">
<tspan font-family="ectt" font-size="1000">OPEN_VERB_FOR_JS_FILES</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Open2</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">OPEN_VERB_FOR_VBS_FILES</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Open2</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">OPEN_VERB_FOR_VBE_FILES</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Open2</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">OPEN_VERB_FOR_JSE_FILES</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Open2</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">OPEN_VERB_FOR_WSF_FILES</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Open2</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">OPEN_VERB_FOR_WSH_FILES</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Open2</tspan>
</div>
<!--l. 402--><p class="nopar" >
<!--l. 404--><p class="indent" >   In this example, HTCondor specifies the <span class="obeylines-h"><span class="verb">Open2</span></span> verb, instead of the default <span class="obeylines-h"><span class="verb">Open</span></span> verb, for a script with the file
name extension of <span class="obeylines-h"><span class="verb">wsh</span></span>. The <span class="textit">Windows Scripting Host</span>&#8217;s <span class="obeylines-h"><span class="verb">Open2</span></span> verb allows standard input, standard output, and
standard error to be redirected as needed for HTCondor jobs.
<!--l. 411--><p class="indent" >   A common difficulty is encountered when a script interpreter requires access to the user&#8217;s registry. Note
that the user&#8217;s registry is different than the root registry. If not given access to the user&#8217;s registry,
some scripts, such as <span class="textit">Windows Scripting Host</span> scripts, will fail. The failure error message appears
as:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-974">
<tspan font-family="ectt" font-size="1000">CScript</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Error:</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Loading</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;your</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;settings</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;failed.</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;(Access</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;is</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;denied.)</tspan>
</div>
<!--l. 421--><p class="nopar" >
<!--l. 423--><p class="indent" >   The fix for this error is to give explicit access to the submitting user&#8217;s registry hive. This can be accomplished
with the addition of the <span class="textbf">load_profile</span><a 
 id="dx76-581001"></a> command in the job&#8217;s submit description file:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-975">
<tspan font-family="ectt" font-size="1000">load_profile</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;True</tspan>
</div>
<!--l. 430--><p class="nopar" >
<!--l. 432--><p class="indent" >   With this command, there should be no registry access errors. This command should also work for other
interpreters. Note that not all interpreters will require access. For example, <span class="textit">ActivePerl</span> does not by default require
access to the user&#8217;s registry hive.
<!--l. 441--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.8   </span> <a 
 id="x76-5820008.2.8"></a>How HTCondor for Windows Starts and Stops a Job</h4>
<a 
 id="dx76-582001"></a>
<!--l. 445--><p class="noindent" >This section provides some details on how HTCondor starts and stops jobs. This discussion is geared for the
HTCondor administrator or advanced user who is already familiar with the material in the Administrator&#8217;s
Manual and wishes to know detailed information on what HTCondor does when starting and stopping
jobs.
<!--l. 451--><p class="indent" >   When HTCondor is about to start a job, the <span class="textit">condor_startd</span> on the execute machine spawns a <span class="textit">condor_starter</span>
process. The <span class="textit">condor_starter</span> then creates:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x76-582003x1">a run account on the machine with a login name of condor-slot&#x003C;X&#x003E;, where <span class="texttt">&#x003C;X&#x003E;</span> is the slot number
     of the <span class="textit">condor_starter</span>. This account is added to group <span class="texttt">Users</span> by default. The default group may be
     changed by setting configuration variable <span class="texttt">DYNAMIC_RUN_ACCOUNT_LOCAL_GROUP</span> <a 
 id="dx76-582004"></a><a 
 id="dx76-582005"></a>. This step is skipped
     if the job is to be run using the submitting user&#8217;s account, as specified in section <a 
href="#x76-5770008.2.4">8.2.4<!--tex4ht:ref: sec:windows-run-as-owner --></a>.
     </li>
     <li 
  class="enumerate" id="x76-582007x2">a new temporary working directory for the job on the execute machine. This directory is named
     <span class="texttt">dir_XXX</span>, where <span class="texttt">XXX</span> is the process ID of the <span class="textit">condor_starter</span>. The directory is created in the <span class="texttt">$(EXECUTE)</span>
     directory, as specified in HTCondor&#8217;s configuration file. HTCondor then grants write permission to this
     directory for the user account newly created for the job.
     </li>
     <li 
  class="enumerate" id="x76-582009x3">a new, non-visible Window Station and Desktop for the job. Permissions are set so that only the
     account that will run the job has access rights to this Desktop. Any windows created by this job are
     not seen by anyone; the job is run in the background. Setting <span class="texttt">USE_VISIBLE_DESKTOP</span> <a 
 id="dx76-582010"></a><a 
 id="dx76-582011"></a> to <span class="texttt">True</span> will
     allow the job to access the default desktop instead of a newly created one.
     </li></ol>
                                                                                         

                                                                                         
<!--l. 485--><p class="indent" >   Next, the <span class="textit">condor_starter</span> daemon contacts the <span class="textit">condor_shadow</span> daemon, which is running on the
submitting machine, and the <span class="textit">condor_starter</span> pulls over the job&#8217;s executable and input files. These files
are placed into the temporary working directory for the job. After all files have been received, the
<span class="textit">condor_starter</span> spawns the user&#8217;s executable. Its current working directory set to the temporary working
directory.
<!--l. 493--><p class="indent" >   While the job is running, the <span class="textit">condor_starter</span> closely monitors the CPU usage and image size of all processes
started by the job. Every 20 minutes the <span class="textit">condor_starter</span> sends this information, along with the total size of all files
contained in the job&#8217;s temporary working directory, to the <span class="textit">condor_shadow</span>. The <span class="textit">condor_shadow</span> then inserts this
information into the job&#8217;s ClassAd so that policy and scheduling expressions can make use of this dynamic
information.
<!--l. 502--><p class="indent" >   If the job exits of its own accord (that is, the job completes), the <span class="textit">condor_starter</span> first terminates any processes
started by the job which could still be around if the job did not clean up after itself. The <span class="textit">condor_starter</span> examines
the job&#8217;s temporary working directory for any files which have been created or modified and sends these files back to
the <span class="textit">condor_shadow</span> running on the submit machine. The <span class="textit">condor_shadow</span> places these files into the <span class="textbf">initialdir</span><a 
 id="dx76-582012"></a>
specified in the submit description file; if no <span class="textbf">initialdir</span> was specified, the files go into the directory
where the user invoked <span class="textit">condor_submit</span>. Once all the output files are safely transferred back, the job is
removed from the queue. If, however, the <span class="textit">condor_startd</span> forcibly kills the job before all output files
could be transferred, the job is not removed from the queue but instead switches back to the Idle
state.
<!--l. 520--><p class="indent" >   If the <span class="textit">condor_startd</span> decides to vacate a job prematurely, the <span class="textit">condor_starter</span> sends a WM_CLOSE message to
the job. If the job spawned multiple child processes, the WM_CLOSE message is only sent to the parent process.
This is the one started by the <span class="textit">condor_starter</span>. The WM_CLOSE message is the preferred way to terminate a
process on Windows, since this method allows the job to clean up and free any resources it may have
allocated. When the job exits, the <span class="textit">condor_starter</span> cleans up any processes left behind. At this point, if
<span class="textbf">when_to_transfer_output</span><a 
 id="dx76-582013"></a> is set to <span class="texttt">ON_EXIT</span> (the default) in the job&#8217;s submit description file, the job switches
states, from Running to Idle, and no files are transferred back. If <span class="textbf">when_to_transfer_output</span> is set
to <span class="texttt">ON_EXIT_OR_EVICT</span>, then files in the job&#8217;s temporary working directory which were changed or
modified are first sent back to the submitting machine. If exactly which files to transfer is specified
with <span class="textbf">transfer_output_files</span><a 
 id="dx76-582014"></a>, then this modifies the files transferred and can affect the state of the
job if the specified files do not exist. On an eviction, the <span class="textit">condor_shadow</span> places these intermediate
files into a subdirectory created in the <span class="texttt">$(SPOOL)</span> directory on the submitting machine. The job is
then switched back to the Idle state until HTCondor finds a different machine on which to run. When
the job is started again, HTCondor places into the job&#8217;s temporary working directory the executable
and input files as before, <span class="emph">plus</span> any files stored in the submit machine&#8217;s <span class="texttt">$(SPOOL)</span> directory for that
job.
<!--l. 552--><p class="indent" >   <span class="underline">NOTE</span>: A Windows console process can intercept a WM_CLOSE message via the Win32 SetConsoleCtrlHandler()
function, if it needs to do special cleanup work at vacate time; a WM_CLOSE message generates
a CTRL_CLOSE_EVENT. See SetConsoleCtrlHandler() in the Win32 documentation for more
info.
<!--l. 559--><p class="indent" >   <span class="underline">NOTE</span>: The default handler in Windows for a WM_CLOSE message is for the process to exit. Of course, the job
could be coded to ignore it and not exit, but eventually the <span class="textit">condor_startd</span> will become impatient and hard-kill the
job, if that is the policy desired by the administrator.
                                                                                         

                                                                                         
<!--l. 564--><p class="indent" >   Finally, after the job has left and any files transferred back, the <span class="textit">condor_starter</span> deletes the temporary working
directory, the temporary account if one was created, the Window Station and the Desktop before exiting. If the
<span class="textit">condor_starter</span> should terminate abnormally, the <span class="textit">condor_startd</span> attempts the clean up. If for some reason the
<span class="textit">condor_startd</span> should disappear as well (that is, if the entire machine was power-cycled hard), the <span class="textit">condor_startd</span>
will clean up when HTCondor is restarted.
<!--l. 575--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.9   </span> <a 
 id="x76-5830008.2.9"></a>Security Considerations in HTCondor for Windows</h4>
<!--l. 578--><p class="noindent" >On the execute machine (by default), the user job is run using the access token of an account dynamically created
by HTCondor which has bare-bones access rights and privileges. For instance, if your machines are configured so
that only Administrators have write access to <span class="obeylines-h"><span class="verb">C:\WINNT</span></span>, then certainly no HTCondor job run on that machine
would be able to write anything there. The only files the job should be able to access on the execute machine are
files accessible by the Users and Everyone groups, and files in the job&#8217;s temporary working directory.
Of course, if the job is configured to run using the account of the submitting user (as described in
section <a 
href="#x76-5770008.2.4">8.2.4<!--tex4ht:ref: sec:windows-run-as-owner --></a>), it will be able to do anything that the user is able to do on the execute machine it runs
on.
<!--l. 592--><p class="indent" >   On the submit machine, HTCondor impersonates the submitting user, therefore the File Transfer mechanism has
the same access rights as the submitting user. For example, say only Administrators can write to <span class="obeylines-h"><span class="verb">C:\WINNT</span></span> on the
submit machine, and a user gives the following to <span class="textit">condor_submit</span> :
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-976">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;executable</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;mytrojan.exe</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;initialdir</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;c:\winnt</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;output</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;=</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;explorer.exe</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;queue</tspan>
</div>
<!--l. 603--><p class="nopar" > Unless that user is in group Administrators, HTCondor will not permit <span class="texttt">explorer.exe</span> to be overwritten.
<!--l. 607--><p class="indent" >   If for some reason the submitting user&#8217;s account disappears between the time <span class="textit">condor_submit</span> was run and when
the job runs, HTCondor is not able to check and see if the now-defunct submitting user has read/write access to a
given file. In this case, HTCondor will ensure that group &#8220;Everyone&#8221; has read or write access to any file the job
subsequently tries to read or write. This is in consideration for some network setups, where the user account only
exists for as long as the user is logged in.
<!--l. 615--><p class="indent" >   HTCondor also provides protection to the job queue. It would be bad if the integrity of the job queue is
compromised, because a malicious user could remove other user&#8217;s jobs or even change what executable a user&#8217;s job
will run. To guard against this, in HTCondor&#8217;s default configuration all connections to the <span class="textit">condor_schedd</span> (the
process which manages the job queue on a given machine) are authenticated using Windows&#8217; eSSPI security layer.
The user is then authenticated using the same challenge-response protocol that Windows uses to authenticate users
to Windows file servers. Once authenticated, the only users allowed to edit job entry in the queue
are:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x76-583002x1">the user who originally submitted that job (i.e. HTCondor allows users to remove or edit their own
     jobs)
     </li>
     <li 
  class="enumerate" id="x76-583004x2">users listed in the <span class="texttt">condor_config</span> file parameter <span class="texttt">QUEUE_SUPER_USERS</span>. In the default configuration,
     only the &#8220;SYSTEM&#8221; (LocalSystem) account is listed here.</li></ol>
<!--l. 631--><p class="noindent" ><span class="underline">WARNING</span>: Do not remove &#8220;SYSTEM&#8221; from <span class="texttt">QUEUE_SUPER_USERS</span>, or HTCondor itself will not be able to access the job
queue when needed. If the LocalSystem account on your machine is compromised, you have all sorts of
problems!
<!--l. 636--><p class="indent" >   To protect the actual job queue files themselves, the HTCondor installation program will automatically set
permissions on the entire HTCondor release directory so that only Administrators have write access.
<!--l. 640--><p class="indent" >   Finally, HTCondor has all the IP/Host-based security mechanisms present in the full-blown version of
HTCondor. See section&#x00A0;<a 
href="Security.html#x36-2920003.8.9">3.8.9<!--tex4ht:ref: sec:Host-Security --></a> starting on page&#x00A0;<a 
href="Security.html#x36-2920003.8.9">1052<!--tex4ht:ref: sec:Host-Security --></a> for complete information on how to allow/deny access to
HTCondor based upon machine host name or IP address.
<!--l. 648--><p class="noindent" >
                                                                                         

                                                                                         
   <h4 class="subsectionHead"><span class="titlemark">8.2.10   </span> <a 
 id="x76-5840008.2.10"></a>Network files and HTCondor</h4>
<!--l. 651--><p class="noindent" >HTCondor can work well with a network file server. The recommended approach to having jobs access files on
network shares is to configure jobs to run using the security context of the submitting user (see section <a 
href="#x76-5770008.2.4">8.2.4<!--tex4ht:ref: sec:windows-run-as-owner --></a>). If this
is done, the job will be able to access resources on the network in the same way as the user can when logged in
interactively.
<!--l. 658--><p class="indent" >   In some environments, running jobs as their submitting users is not a feasible option. This section outlines
some possible alternatives. The heart of the difficulty in this case is that on the execute machine,
HTCondor creates a temporary user that will run the job. The file server has never heard of this user
before.
<!--l. 664--><p class="indent" >   Choose one of these methods to make it work:
     <ul class="itemize1">
     <li class="itemize">METHOD A: access the file server as a different user via a net use command with a login and password
     </li>
     <li class="itemize">METHOD B: access the file server as guest
     </li>
     <li class="itemize">METHOD C: access the file server with a "NULL" descriptor
     </li>
     <li class="itemize">METHOD D: create and have HTCondor use a special account</li></ul>
<!--l. 674--><p class="indent" >   All of these methods have advantages and disadvantages.
<!--l. 676--><p class="indent" >   Here are the methods in more detail:
<!--l. 678--><p class="indent" >   METHOD A - access the file server as a different user via a net use command with a login and
password
<!--l. 681--><p class="indent" >   Example: you want to copy a file off of a server before running it....
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-977">
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;@echo</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;off</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;net</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;use</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\\myserver\someshare</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;MYPASSWORD</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;/USER:MYLOGIN</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;copy</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;\\myserver\someshare\my-program.exe</tspan>
<tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;</tspan><tspan font-family="ectt" font-size="0800">&#x00A0;my-program.exe</tspan>
</div>
<!--l. 689--><p class="nopar" >
<!--l. 692--><p class="indent" >   The idea here is to simply authenticate to the file server with a different login than the temporary HTCondor
login. This is easy with the "net use" command as shown above. Of course, the obvious disadvantage is this user&#8217;s
password is stored and transferred as clear text.
<!--l. 697--><p class="indent" >   METHOD B - access the file server as guest
<!--l. 699--><p class="indent" >   Example: you want to copy a file off of a server before running it as GUEST
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-978">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;@echo</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;off</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;net</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;use</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;\\myserver\someshare</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;copy</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;\\myserver\someshare\my-program.exe</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;my-program.exe</tspan>
</div>
<!--l. 706--><p class="nopar" >
<!--l. 708--><p class="indent" >   In this example, you&#8217;d contact the server MYSERVER as the HTCondor temporary user. However, if you have
the GUEST account enabled on MYSERVER, you will be authenticated to the server as user "GUEST". If your file
permissions (ACLs) are setup so that either user GUEST (or group EVERYONE) has access the share
"someshare" and the directories/files that live there, you can use this method. The downside of this
method is you need to enable the GUEST account on your file server. <span class="underline">WARNING</span>: This should be done
*with extreme caution* and only if your file server is well protected behind a firewall that blocks SMB
traffic.
<!--l. 718--><p class="indent" >   METHOD C - access the file server with a "NULL" descriptor
<!--l. 720--><p class="indent" >   One more option is to use NULL Security Descriptors. In this way, you can specify which shares are
accessible by NULL Descriptor by adding them to your registry. You can then use the batch file wrapper
like:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-979">
<tspan font-family="ectt" font-size="1000">net</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;use</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;z:</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;\\myserver\someshare</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;/USER:""</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">z:\my-program.exe</tspan>
</div>
<!--l. 727--><p class="nopar" >
<!--l. 729--><p class="indent" >   so long as &#8217;someshare&#8217; is in the list of allowed NULL session shares. To edit this list, run regedit.exe and navigate
to the key:
                                                                                         

                                                                                         
   <div class="verbatim" id="verbatim-980">
<tspan font-family="ectt" font-size="1000">HKEY_LOCAL_MACHINE\</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;SYSTEM\</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;CurrentControlSet\</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Services\</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;LanmanServer\</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;Parameters\</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;NullSessionShares</tspan>
</div>
<!--l. 740--><p class="nopar" >
<!--l. 742--><p class="indent" >   and edit it. unfortunately it is a binary value, so you&#8217;ll then need to type in the hex ASCII codes to spell out
your share. each share is separated by a null (0x00) and the last in the list is terminated with two
nulls.
<!--l. 747--><p class="indent" >   although a little more difficult to set up, this method of sharing is a relatively safe way to have one quasi-public
share without opening the whole guest account. you can control specifically which shares can be accessed or not via
the registry value mentioned above.
<!--l. 753--><p class="indent" >   METHOD D - create and have HTCondor use a special account
<!--l. 755--><p class="indent" >   Create a permanent account (called condor-guest in this description) under which HTCondor will run jobs. On
all Windows machines, and on the file server, create the condor-guest account.
<!--l. 760--><p class="indent" >   On the network file server, give the condor-guest user permissions to access files needed to run HTCondor
jobs.
<!--l. 763--><p class="indent" >   Securely store the password of the condor-guest user in the Windows registry using <span class="textit">condor_store_cred</span> on all
Windows machines.
<!--l. 767--><p class="indent" >   Tell HTCondor to use the condor-guest user as the owner of jobs, when required. Details for this are in
section&#x00A0;<a 
href="Security.html#x36-2980003.8.13">3.8.13<!--tex4ht:ref: sec:RunAsNobody --></a>.
<!--l. 773--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.11   </span> <a 
 id="x76-5850008.2.11"></a>Interoperability between HTCondor for Unix and HTCondor for Windows</h4>
<!--l. 776--><p class="noindent" >Unix machines and Windows machines running HTCondor can happily co-exist in the same HTCondor pool without
any problems. Jobs submitted on Windows can run on Windows or Unix, and jobs submitted on Unix can run on
Unix or Windows. Without any specification using the <span class="textbf">Requirements</span><a 
 id="dx76-585001"></a> command in the submit description file, the
default behavior will be to require the execute machine to be of the same architecture and operating system as the
submit machine.
                                                                                         

                                                                                         
<!--l. 786--><p class="indent" >   There is absolutely no need to run more than one HTCondor central manager, even if there are both Unix and
Windows machines in the pool. The HTCondor central manager itself can run on either Unix or Windows; there is
no advantage to choosing one over the other.
<!--l. 793--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">8.2.12   </span> <a 
 id="x76-5860008.2.12"></a>Some differences between HTCondor for Unix -vs- HTCondor for Windows</h4>
     <ul class="itemize1">
     <li class="itemize">On Unix, we recommend the creation of a condor account when installing HTCondor. On Windows,
     this is not necessary, as HTCondor is designed to run as a system service as user LocalSystem.
     </li>
     <li class="itemize">On Unix, HTCondor finds the <span class="texttt">condor_config</span> main configuration file by looking in &#x02DC;condor, in <span class="texttt">/etc</span>,
     or via an environment variable. On Windows, the location of <span class="texttt">condor_config</span> file is determined via the
     registry key <span class="texttt">HKEY_LOCAL_MACHINE/Software/Condor</span>. Override this value by setting an environment
     variable named <span class="texttt">CONDOR_CONFIG</span>.
     </li>
     <li class="itemize">On  Unix,  in  the  vanilla  universe  at  job  vacate  time,  HTCondor  sends  the  job  a  softkill  signal
     defined in the submit description file, which defaults to SIGTERM. On Windows, HTCondor sends a
     WM_CLOSE message to the job at vacate time.
     </li>
     <li class="itemize">On Unix, if one of the HTCondor daemons has a fault, a core file will be created in the <span class="texttt">$(Log)</span> directory.
     On Windows, a core file will also be created, but instead of a memory dump of the process, it will be a
     very short ASCII text file which describes what fault occurred and where it happened. This information
     can be used by the HTCondor developers to fix the problem.
     </li></ul>
<a 
 id="dx76-586001"></a>
                                                                                         

                                                                                         
<!--l. 2--><p class="indent" >   <span style="font-size: 200%;"><a 
href="Linux.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Linux.html#tailLinux.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="MicrosoftWindows.html" >&#x2191;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="PlatformSpecificInformation.html#MicrosoftWindows.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="MacintoshOSX.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><a 
 id="tailMicrosoftWindows.html"></a>  
</body></html> 
